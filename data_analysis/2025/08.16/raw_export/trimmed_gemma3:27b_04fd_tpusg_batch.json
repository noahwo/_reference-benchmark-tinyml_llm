{
  "data": [
    {
      "id": "bf281dd8",
      "timestamp": "2025-08-13T04:07:21.833000+00:00",
      "name": "bf28_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Input Acquisition & Preprocessing Loop\ncap = cv2.VideoCapture(input_video_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Output Interpretation & Handling\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   confidence = output_data[0][5]\n\n   if confidence > 0.5:\n       class_id = int(classes)\n       label = labels[class_id]\n       x1 = int(boxes[0] * frame.shape[1])\n       y1 = int(boxes[1] * frame.shape[0])\n       x2 = int(boxes[2] * frame.shape[1])\n       y2 = int(boxes[3] * frame.shape[0])\n       cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n       cv2.putText(frame, f'{label}: {confidence:.2f}', (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_61ba65d0_1755058208.py\", line 57, in <module>\n    if confidence > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 30
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 175.28,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-07-07-21-835882_chatcmpl-c372ad06-958a-4d4b-90e4-2902fcac22ce",
          "traceId": "bf281dd8",
          "type": "GENERATION",
          "name": "bf28_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T04:07:21.835000+00:00",
          "endTime": "2025-08-13T04:07:45.807000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 23972.0,
          "environment": "default",
          "completionTokens": 849,
          "totalTokens": 2815,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-07-53-834846_chatcmpl-1fc83033-3460-4b13-88b8-87c74278507a",
          "traceId": "bf281dd8",
          "type": "GENERATION",
          "name": "bf28_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T04:07:53.834000+00:00",
          "endTime": "2025-08-13T04:08:20.636000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26802.0,
          "environment": "default",
          "completionTokens": 957,
          "totalTokens": 3005,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-08-28-735724_chatcmpl-fb5ee4d4-964b-4e0a-913e-a02b5d51cb59",
          "traceId": "bf281dd8",
          "type": "GENERATION",
          "name": "bf28_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T04:08:28.735000+00:00",
          "endTime": "2025-08-13T04:08:58.171000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29436.0,
          "environment": "default",
          "completionTokens": 1058,
          "totalTokens": 3106,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-09-06-174301_chatcmpl-86d47b5f-5c57-4ac8-ad6b-4f9ec83f722f",
          "traceId": "bf281dd8",
          "type": "GENERATION",
          "name": "bf28_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T04:09:06.174000+00:00",
          "endTime": "2025-08-13T04:09:32.792000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26618.0,
          "environment": "default",
          "completionTokens": 950,
          "totalTokens": 2998,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-09-40-923566_chatcmpl-48c21568-c2b6-456d-94ee-134eb859086c",
          "traceId": "bf281dd8",
          "type": "GENERATION",
          "name": "bf28_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T04:09:40.923000+00:00",
          "endTime": "2025-08-13T04:10:08.919000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27996.0,
          "environment": "default",
          "completionTokens": 1003,
          "totalTokens": 3051,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "38106f96-8cd9-4722-a398-f5793015b71e",
          "traceId": "bf281dd8",
          "type": "SPAN",
          "name": "error_bf_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T04:10:17.115000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_61ba65d0_1755058208.py\", line 57, in <module>\n    if confidence > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T04:10:22.549Z",
      "createdAt": "2025-08-13T04:07:22.351Z"
    },
    {
      "id": "c671d96f",
      "timestamp": "2025-08-13T04:03:58.930000+00:00",
      "name": "c671_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Inference Loop\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if input_data_type == np.float32:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n   else:\n       input_data = input_data.astype(np.uint8)\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Post-processing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0]\n   classes = output_data[1]\n   scores = output_data[2]\n\n   threshold = 0.5\n   for i in range(len(scores)):\n       if scores[i] > threshold:\n           x1, y1, x2, y2 = boxes[i]\n           x1, y1, x2, y2 = int(x1 * frame_width), int(y1 * frame_height), int(x2 * frame_width), int(y2 * frame_height)\n           class_id = int(classes[i])\n           label = labels[class_id]\n           confidence = scores[i]\n\n           cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n           cv2.putText(frame, f\"{label}: {confidence:.2f}\", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   out.write(frame)\n\n# Cleanup\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_320095b9_1755058026.py\", line 66, in <module>\n    classes = output_data[1]\nIndexError: index 1 is out of bounds for axis 0 with size 1"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 29
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 195.292,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-07-03-58-932165_chatcmpl-c5c35141-2151-46f1-93b5-2513145796a7",
          "traceId": "c671d96f",
          "type": "GENERATION",
          "name": "c671_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T04:03:58.932000+00:00",
          "endTime": "2025-08-13T04:04:25.592000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26660.0,
          "environment": "default",
          "completionTokens": 948,
          "totalTokens": 2914,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-04-33-663056_chatcmpl-cbcc44b9-9caa-4c4c-af8f-b020cf107284",
          "traceId": "c671d96f",
          "type": "GENERATION",
          "name": "c671_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T04:04:33.663000+00:00",
          "endTime": "2025-08-13T04:05:06.029000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32366.0,
          "environment": "default",
          "completionTokens": 1172,
          "totalTokens": 3220,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-05-14-184290_chatcmpl-9a3e5336-f192-4284-a398-6a9291657ee3",
          "traceId": "c671d96f",
          "type": "GENERATION",
          "name": "c671_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T04:05:14.184000+00:00",
          "endTime": "2025-08-13T04:05:44.983000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30799.0,
          "environment": "default",
          "completionTokens": 1110,
          "totalTokens": 3158,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-05-53-130200_chatcmpl-89ac585d-cad1-4159-a5a3-d082eeb3ab2e",
          "traceId": "c671d96f",
          "type": "GENERATION",
          "name": "c671_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T04:05:53.130000+00:00",
          "endTime": "2025-08-13T04:06:24.304000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31174.0,
          "environment": "default",
          "completionTokens": 1125,
          "totalTokens": 3173,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-06-32-449083_chatcmpl-4929ef98-6242-41f4-af7d-29ba7f248c7b",
          "traceId": "c671d96f",
          "type": "GENERATION",
          "name": "c671_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T04:06:32.449000+00:00",
          "endTime": "2025-08-13T04:07:06.112000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 33663.0,
          "environment": "default",
          "completionTokens": 1225,
          "totalTokens": 3273,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "a8ee5da3-6c44-4b91-929f-cdacb24e7b1c",
          "traceId": "c671d96f",
          "type": "SPAN",
          "name": "error_c6_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T04:07:14.224000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_320095b9_1755058026.py\", line 66, in <module>\n    classes = output_data[1]\nIndexError: index 1 is out of bounds for axis 0 with size 1",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T04:07:19.719Z",
      "createdAt": "2025-08-13T04:03:59.449Z"
    },
    {
      "id": "285d4385",
      "timestamp": "2025-08-13T04:00:40.981000+00:00",
      "name": "285d_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Input Acquisition & Preprocessing Loop\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video stream or file\")\n   exit()\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   # Normalize the input data\n   if input_data_type == np.uint8:\n       input_data = input_data.astype(np.float32) / 255.0\n   elif input_data_type == np.float32:\n       input_data = input_data\n   else:\n       print(\"Unsupported input data type:\", input_data_type)\n       exit()\n   \n   # Convert to correct datatype\n   if input_data_type == np.uint8:\n       input_data = input_data.astype(np.uint8)\n   elif input_data_type == np.float32:\n       input_data = input_data.astype(np.float32)\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Output Interpretation & Handling\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   \n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   scores = output_data[0][5]\n\n   if scores > 0.5:\n       x1 = int(boxes[0] * frame.shape[1])\n       y1 = int(boxes[1] * frame.shape[0])\n       x2 = int(boxes[2] * frame.shape[1])\n       y2 = int(boxes[3] * frame.shape[0])\n\n       class_id = int(classes)\n       label = labels[class_id]\n       confidence = scores\n\n       cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n       cv2.putText(frame, f\"{label}: {confidence:.2f}\", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_a3d2fa68_1755057824.py\", line 75, in <module>\n    if scores > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 28
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 191.795,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-07-00-40-983568_chatcmpl-3882ec16-75a2-42cf-9709-a2340f58bf63",
          "traceId": "285d4385",
          "type": "GENERATION",
          "name": "285d_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T04:00:40.983000+00:00",
          "endTime": "2025-08-13T04:01:04.773000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 23790.0,
          "environment": "default",
          "completionTokens": 841,
          "totalTokens": 2807,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-01-12-540431_chatcmpl-eece820d-6b7a-44c1-a983-6883a8b54121",
          "traceId": "285d4385",
          "type": "GENERATION",
          "name": "285d_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T04:01:12.540000+00:00",
          "endTime": "2025-08-13T04:01:43.590000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31050.0,
          "environment": "default",
          "completionTokens": 1121,
          "totalTokens": 3169,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-01-51-520932_chatcmpl-97e32bb0-7a4d-4733-9dda-1ed77cf096e7",
          "traceId": "285d4385",
          "type": "GENERATION",
          "name": "285d_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T04:01:51.520000+00:00",
          "endTime": "2025-08-13T04:02:24.407000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32887.0,
          "environment": "default",
          "completionTokens": 1192,
          "totalTokens": 3240,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-02-32-215192_chatcmpl-9d06c42b-b0bf-4a8d-9d8b-831046fb91fe",
          "traceId": "285d4385",
          "type": "GENERATION",
          "name": "285d_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T04:02:32.215000+00:00",
          "endTime": "2025-08-13T04:03:04.731000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32516.0,
          "environment": "default",
          "completionTokens": 1178,
          "totalTokens": 3226,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-07-03-12-698949_chatcmpl-f74655d1-b11d-4a4b-9aeb-02c473fca414",
          "traceId": "285d4385",
          "type": "GENERATION",
          "name": "285d_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T04:03:12.698000+00:00",
          "endTime": "2025-08-13T04:03:44.681000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31983.0,
          "environment": "default",
          "completionTokens": 1156,
          "totalTokens": 3204,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "36e47fea-c692-490e-9cab-f6dbd94c8158",
          "traceId": "285d4385",
          "type": "SPAN",
          "name": "error_28_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T04:03:52.778000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_a3d2fa68_1755057824.py\", line 75, in <module>\n    if scores > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T04:03:58.230Z",
      "createdAt": "2025-08-13T04:00:41.504Z"
    },
    {
      "id": "72460b7c",
      "timestamp": "2025-08-13T03:57:22.169000+00:00",
      "name": "7246_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nconfidence_threshold  = 0.5\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Initialize Video Capture and Writer\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file.\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n\n# Input Acquisition & Preprocessing Loop\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Resize and Preprocess\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Get Output\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n\n   # Interpret Results\n   boxes = output_data[0]\n   classes = output_data[1]\n   scores = output_data[2]\n\n   # Post-processing\n   for i in range(len(boxes)):\n       if scores[i] > confidence_threshold:\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame_width)\n           xmax = int(xmax * frame_width)\n           ymin = int(ymin * frame_height)\n           ymax = int(ymax * frame_height)\n\n           class_id = int(classes[i])\n           label = labels[class_id]\n\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           cv2.putText(frame, f\"{label}: {scores[i]:.2f}\", (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   # Handle Output\n   out.write(frame)\n\n# Cleanup\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_2df18abf_1755057626.py\", line 67, in <module>\n    classes = output_data[1]\nIndexError: index 1 is out of bounds for axis 0 with size 1"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 27
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 192.84,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-57-22-170911_chatcmpl-ad97d30a-9a64-4f80-bd90-22ec1a7f9e46",
          "traceId": "72460b7c",
          "type": "GENERATION",
          "name": "7246_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:57:22.170000+00:00",
          "endTime": "2025-08-13T03:57:48.690000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26520.0,
          "environment": "default",
          "completionTokens": 946,
          "totalTokens": 2912,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-57-56-651441_chatcmpl-47324445-5a8f-41c5-85aa-03fd83e2f994",
          "traceId": "72460b7c",
          "type": "GENERATION",
          "name": "7246_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:57:56.651000+00:00",
          "endTime": "2025-08-13T03:58:27.546000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30895.0,
          "environment": "default",
          "completionTokens": 1115,
          "totalTokens": 3163,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-58-35-672549_chatcmpl-18f69648-799c-4dbc-98d0-1cd969363239",
          "traceId": "72460b7c",
          "type": "GENERATION",
          "name": "7246_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:58:35.672000+00:00",
          "endTime": "2025-08-13T03:59:07.738000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32066.0,
          "environment": "default",
          "completionTokens": 1159,
          "totalTokens": 3207,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-59-16-020700_chatcmpl-a45742c4-1bf8-46ff-9d74-713bd6af76d4",
          "traceId": "72460b7c",
          "type": "GENERATION",
          "name": "7246_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:59:16.020000+00:00",
          "endTime": "2025-08-13T03:59:46.543000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30523.0,
          "environment": "default",
          "completionTokens": 1101,
          "totalTokens": 3149,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-59-54-657643_chatcmpl-ad13af99-ce52-4da7-bc84-3ce68e91fc99",
          "traceId": "72460b7c",
          "type": "GENERATION",
          "name": "7246_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:59:54.657000+00:00",
          "endTime": "2025-08-13T04:00:26.874000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32217.0,
          "environment": "default",
          "completionTokens": 1167,
          "totalTokens": 3215,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "7e43a77c-38ad-43ca-b7ac-f0980ac158ce",
          "traceId": "72460b7c",
          "type": "SPAN",
          "name": "error_72_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T04:00:35.010000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_2df18abf_1755057626.py\", line 67, in <module>\n    classes = output_data[1]\nIndexError: index 1 is out of bounds for axis 0 with size 1",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T04:00:40.458Z",
      "createdAt": "2025-08-13T03:57:22.689Z"
    },
    {
      "id": "5a0bac0f",
      "timestamp": "2025-08-13T03:54:20.348000+00:00",
      "name": "5a0b_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import tensorflow as tf\nimport cv2\nimport numpy as np\n\n# Load the labels\nwith open('labels.txt', 'r') as f:\n  labels = [line.strip() for line in f]\n\n# Load the model\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_details  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n\n# Load the video\ninput_path = \"/home/mendel/tinyml_autopilot/data/sheeps.mp4\"\ncap = cv2.VideoCapture(input_path)\n\nif not cap.isOpened():\n  print(\"Error opening video stream or file\")\n  exit()\n\n# Get video properties\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\n# Define output video properties\noutput_path = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Process each frame\nwhile(cap.isOpened()):\n  ret, frame = cap.read()\n  if not ret:\n      break\n\n  # Preprocess the frame\n  resized_frame = cv2.resize(frame, (300, 300))\n  input_data = np.expand_dims(resized_frame, axis=0)\n  input_data = input_data.astype(np.float32)\n  input_data = input_data / 255.0\n\n  # Run inference\n  interpreter.set_tensor(input_details[0]['index'], input_data)\n  interpreter.invoke()\n\n  # Get the output\n  output_data = interpreter.get_tensor(output_details[0]['index'])\n\n  # Process the detections\n  boxes = output_data[0, ..., 1:5]\n  classes = output_data[0, ..., 5]\n  scores = output_data[0, ..., 6]\n\n  # Filter detections by score\n  threshold = 0.5\n  for i in range(len(scores)):\n      if scores[i] > threshold:\n          # Scale bounding boxes\n          ymin, xmin, ymax, xmax = boxes[i]\n          xmin = int(xmin * frame_width)\n          xmax = int(xmax * frame_width)\n          ymin = int(ymin * frame_height)\n          ymax = int(ymax * frame_height)\n\n          # Draw bounding boxes and labels\n          label_id = int(classes[i])\n          label = labels[label_id]\n          cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n          cv2.putText(frame, f\"{label}: {scores[i]:.2f}\", (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n  # Write the output frame to the video file\n  out.write(frame)\n\n  # Display the resulting frame\n  cv2.imshow('frame', frame)\n\n  # Exit if 'q' is pressed\n  if cv2.waitKey(1) & 0xFF == ord('q'):\n      break\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_3b3b9286_1755057431.py\", line 1, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 26
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 175.004,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-54-20-350753_chatcmpl-6e100d10-c108-419c-8c8f-01de1065bccb",
          "traceId": "5a0bac0f",
          "type": "GENERATION",
          "name": "5a0b_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:54:20.350000+00:00",
          "endTime": "2025-08-13T03:54:48.913000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28563.0,
          "environment": "default",
          "completionTokens": 1022,
          "totalTokens": 2988,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-54-56-780506_chatcmpl-d8d0560f-8852-4290-b4f9-6c6ced966edb",
          "traceId": "5a0bac0f",
          "type": "GENERATION",
          "name": "5a0b_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:54:56.780000+00:00",
          "endTime": "2025-08-13T03:55:32.913000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 36133.0,
          "environment": "default",
          "completionTokens": 1318,
          "totalTokens": 3366,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-55-36-725564_chatcmpl-98bf7f66-f946-4e98-a7a8-9eb00afcbb97",
          "traceId": "5a0bac0f",
          "type": "GENERATION",
          "name": "5a0b_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:55:36.725000+00:00",
          "endTime": "2025-08-13T03:56:09.273000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32548.0,
          "environment": "default",
          "completionTokens": 1180,
          "totalTokens": 3228,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-56-13-141629_chatcmpl-83577de3-49bf-4838-b80f-45f0236d6068",
          "traceId": "5a0bac0f",
          "type": "GENERATION",
          "name": "5a0b_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:56:13.141000+00:00",
          "endTime": "2025-08-13T03:56:40.616000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27475.0,
          "environment": "default",
          "completionTokens": 983,
          "totalTokens": 3031,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-56-44-493125_chatcmpl-48fa874d-7e95-44cf-9b9e-3a3bd0dd242d",
          "traceId": "5a0bac0f",
          "type": "GENERATION",
          "name": "5a0b_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:56:44.493000+00:00",
          "endTime": "2025-08-13T03:57:11.449000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26956.0,
          "environment": "default",
          "completionTokens": 963,
          "totalTokens": 3011,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "cb20bc8d-2b73-4d1b-93ac-85fe84137a05",
          "traceId": "5a0bac0f",
          "type": "SPAN",
          "name": "error_5a_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:57:15.354000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_3b3b9286_1755057431.py\", line 1, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:57:20.585Z",
      "createdAt": "2025-08-13T03:54:20.866Z"
    },
    {
      "id": "ecf2b140",
      "timestamp": "2025-08-13T03:50:52.768000+00:00",
      "name": "ecf2_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\n\n# 1.4. Load Interpreter with EdgeTPU\ntry:\n    interpreter = cv2.dnn.readNet('detect.tflite')\n    interpreter.setPreferableBackend(cv2.dnn.DNN_BACKEND_CUDA)  # Try CUDA first\n    interpreter.setPreferableTarget(cv2.dnn.DNN_TARGET_CUDA)\nexcept Exception as e:\n    print(f\"Error loading with CUDA: {e}\")\n    print(\"Falling back to CPU...\")\n    interpreter = cv2.dnn.readNet('detect.tflite')\n    interpreter.setPreferableBackend(cv2.dnn.DNN_BACKEND_CPU)\n    interpreter.setPreferableTarget(cv2.dnn.DNN_TARGET_CPU)\n\ninput_shape  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\n#input_shape = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\n\n# Phase 2: Input Acquisition & Preprocessing Loop\n# 2.1. Acquire Input Data\nvideo_path = 'sheeps.mp4'\ncap = cv2.VideoCapture(video_path)\nif not cap.isOpened():\n    print(\"Error opening video file\")\n    exit()\n\n# Initialize output video writer\noutput_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\n# Phase 4: Output Interpretation & Handling Loop\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # 2.2. Preprocess Data\n    resized_frame = cv2.resize(frame, input_shape)\n    resized_frame = resized_frame.astype(np.float32) / 255.0\n    input_data = np.expand_dims(resized_frame, axis=0)\n    # input_data = np.transpose(input_data, (0, 3, 1, 2)) # Adjust if needed\n\n    # Phase 3: Inference\n    interpreter.setInput(input_data)\n    output_data = interpreter.forward()\n\n    # 4.2. Interpret Results\n    # Assuming output_data is a list of detections\n    # Adjust these indices based on your model's output format\n    boxes = output_data[0][0:4]\n    classes = output_data[0][4]\n    scores = output_data[0][5]\n\n    # 4.3. Post-processing\n    confidence_threshold = 0.5\n    if scores > confidence_threshold:\n        # Convert bounding box coordinates to absolute pixel values\n        box_x = int(boxes[0] * frame.shape[1])\n        box_y = int(boxes[1] * frame.shape[0])\n        box_w = int(boxes[2] * frame.shape[1])\n        box_h = int(boxes[3] * frame.shape[0])\n\n        # Draw bounding box and label\n        label = \"sheep\"  # labels[int(classes)]\n        cv2.rectangle(frame, (box_x, box_y), (box_x + box_w, box_y + box_h), (0, 255, 0), 2)\n        cv2.putText(frame, f\"{label}: {scores:.2f}\", (box_x, box_y - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n    # 4.4. Handle Output\n    out.write(frame)\n    cv2.imshow('Object Detection', frame)\n\n    if cv2.waitKey(1) & 0xFF == ord('q'):\n        break\n\n# Phase 5: Cleanup\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Error loading with CUDA: module 'cv2' has no attribute 'dnn'\nFalling back to CPU...\nTraceback (most recent call last):\n  File \"script_2fd9771b_1755057245.py\", line 6, in <module>\n    interpreter = cv2.dnn.readNet('detect.tflite')\nAttributeError: module 'cv2' has no attribute 'dnn'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"script_2fd9771b_1755057245.py\", line 12, in <module>\n    interpreter = cv2.dnn.readNet('detect.tflite')\nAttributeError: module 'cv2' has no attribute 'dnn'"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 25
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 199.857,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-50-52-769950_chatcmpl-41e36e7b-0e25-4a80-bc98-afc72bc441f3",
          "traceId": "ecf2b140",
          "type": "GENERATION",
          "name": "ecf2_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:50:52.769000+00:00",
          "endTime": "2025-08-13T03:51:22.529000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29760.0,
          "environment": "default",
          "completionTokens": 1068,
          "totalTokens": 3034,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-51-30-641736_chatcmpl-c3c96433-8694-449a-a658-099f8e6f379e",
          "traceId": "ecf2b140",
          "type": "GENERATION",
          "name": "ecf2_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:51:30.641000+00:00",
          "endTime": "2025-08-13T03:52:00.766000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30125.0,
          "environment": "default",
          "completionTokens": 1087,
          "totalTokens": 3135,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-52-04-555500_chatcmpl-b8a2e938-c4f3-4fda-bcc4-224029852d07",
          "traceId": "ecf2b140",
          "type": "GENERATION",
          "name": "ecf2_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:52:04.555000+00:00",
          "endTime": "2025-08-13T03:52:40.229000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 35674.0,
          "environment": "default",
          "completionTokens": 1302,
          "totalTokens": 3350,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-52-47-647794_chatcmpl-417579e7-5050-44d4-b6e9-24eb013f935d",
          "traceId": "ecf2b140",
          "type": "GENERATION",
          "name": "ecf2_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:52:47.647000+00:00",
          "endTime": "2025-08-13T03:53:26.061000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 38414.0,
          "environment": "default",
          "completionTokens": 1407,
          "totalTokens": 3455,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-53-33-638285_chatcmpl-dc840b0f-aecf-4d51-8b43-0daf3875554e",
          "traceId": "ecf2b140",
          "type": "GENERATION",
          "name": "ecf2_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:53:33.638000+00:00",
          "endTime": "2025-08-13T03:54:05.163000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31525.0,
          "environment": "default",
          "completionTokens": 1140,
          "totalTokens": 3188,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "e05ba226-4009-4f2d-a3f7-0492145b78c6",
          "traceId": "ecf2b140",
          "type": "SPAN",
          "name": "error_ec_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:54:12.626000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Error loading with CUDA: module 'cv2' has no attribute 'dnn'\nFalling back to CPU...\nTraceback (most recent call last):\n  File \"script_2fd9771b_1755057245.py\", line 6, in <module>\n    interpreter = cv2.dnn.readNet('detect.tflite')\nAttributeError: module 'cv2' has no attribute 'dnn'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"script_2fd9771b_1755057245.py\", line 12, in <module>\n    interpreter = cv2.dnn.readNet('detect.tflite')\nAttributeError: module 'cv2' has no attribute 'dnn'",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:54:18.066Z",
      "createdAt": "2025-08-13T03:50:53.288Z"
    },
    {
      "id": "4a65e9b4",
      "timestamp": "2025-08-13T03:47:26.110000+00:00",
      "name": "4a65_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\nfloating_model = (input_data_type == np.float32)\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Inference Loop\nwhile(cap.isOpened()):\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Post-processing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[..., 0:4]\n   classes = output_data[..., 4]\n   scores = output_data[..., 5]\n\n   threshold = 0.5\n   for i in range(boxes.shape[0]):\n       if scores[i] > threshold:\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame_width)\n           xmax = int(xmax * frame_width)\n           ymin = int(ymin * frame_height)\n           ymax = int(ymax * frame_height)\n\n           class_id = int(classes[i])\n           label = labels[class_id]\n           confidence = scores[i]\n\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           label_text = f\"{label}: {confidence:.2f}\"\n           cv2.putText(frame, label_text, (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   out.write(frame)\n   cv2.imshow('Object Detection', frame)\n   if cv2.waitKey(1) & 0xFF == ord('q'):\n       break\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_3280d061_1755057039.py\", line 63, in <module>\n    classes = output_data[..., 4]\nIndexError: index 4 is out of bounds for axis 2 with size 4"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 24
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 201.493,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-47-26-112347_chatcmpl-a52f5c6e-10de-4fc1-a733-57ca00cadf3f",
          "traceId": "4a65e9b4",
          "type": "GENERATION",
          "name": "4a65_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:47:26.112000+00:00",
          "endTime": "2025-08-13T03:47:52.989000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26877.0,
          "environment": "default",
          "completionTokens": 960,
          "totalTokens": 2926,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-48-01-073065_chatcmpl-fd5f70f2-2380-49ad-b82c-9003cc4a9c9a",
          "traceId": "4a65e9b4",
          "type": "GENERATION",
          "name": "4a65_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:48:01.073000+00:00",
          "endTime": "2025-08-13T03:48:33.783000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32710.0,
          "environment": "default",
          "completionTokens": 1186,
          "totalTokens": 3234,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-48-41-969364_chatcmpl-b7c1e8a1-7971-4d5c-bfbe-78f3dff16aba",
          "traceId": "4a65e9b4",
          "type": "GENERATION",
          "name": "4a65_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:48:41.969000+00:00",
          "endTime": "2025-08-13T03:49:13.717000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31748.0,
          "environment": "default",
          "completionTokens": 1148,
          "totalTokens": 3196,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-49-21-953680_chatcmpl-dc268b83-3cb8-46dc-97ba-54a8ce0f118f",
          "traceId": "4a65e9b4",
          "type": "GENERATION",
          "name": "4a65_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:49:21.953000+00:00",
          "endTime": "2025-08-13T03:49:56.590000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 34637.0,
          "environment": "default",
          "completionTokens": 1261,
          "totalTokens": 3309,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-50-04-741015_chatcmpl-bb387915-4faa-49a5-a557-608b74d754e3",
          "traceId": "4a65e9b4",
          "type": "GENERATION",
          "name": "4a65_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:50:04.741000+00:00",
          "endTime": "2025-08-13T03:50:39.551000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 34810.0,
          "environment": "default",
          "completionTokens": 1268,
          "totalTokens": 3316,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "b54397af-2c8f-4cf1-b07e-3d753e72f860",
          "traceId": "4a65e9b4",
          "type": "SPAN",
          "name": "error_4a_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:50:47.605000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_3280d061_1755057039.py\", line 63, in <module>\n    classes = output_data[..., 4]\nIndexError: index 4 is out of bounds for axis 2 with size 4",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:50:52.842Z",
      "createdAt": "2025-08-13T03:47:26.629Z"
    },
    {
      "id": "8735fe55",
      "timestamp": "2025-08-13T03:44:19.524000+00:00",
      "name": "8735_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\nfloating_model = (input_data_type == np.float32)\n\n# Initialize Video Capture and Output\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video stream or file\")\n   exit()\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\n# Main Loop\nwhile(cap.isOpened()):\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Postprocessing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   scores = output_data[0][5]\n\n   confidence_threshold = 0.5\n\n   if scores > confidence_threshold:\n       class_id = int(classes)\n       label = labels[class_id]\n\n       x1 = int(boxes[0])\n       y1 = int(boxes[1])\n       x2 = int(boxes[2])\n       y2 = int(boxes[3])\n\n       cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n       cv2.putText(frame, f\"{label}: {scores:.2f}\", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n   # Write the output frame\n   out.write(frame)\n\n# Release everything\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_55299f2d_1755056831.py\", line 66, in <module>\n    if scores > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 23
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 180.584,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-44-19-529765_chatcmpl-07d1b236-8cb9-409c-8a73-41785316ddba",
          "traceId": "8735fe55",
          "type": "GENERATION",
          "name": "8735_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:44:19.529000+00:00",
          "endTime": "2025-08-13T03:44:44.417000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 24888.0,
          "environment": "default",
          "completionTokens": 883,
          "totalTokens": 2849,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-44-52-597811_chatcmpl-4eff9e63-79d0-40de-81dc-c4d2d0775f82",
          "traceId": "8735fe55",
          "type": "GENERATION",
          "name": "8735_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:44:52.597000+00:00",
          "endTime": "2025-08-13T03:45:21.505000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28908.0,
          "environment": "default",
          "completionTokens": 1039,
          "totalTokens": 3087,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-45-29-585218_chatcmpl-c7e32277-f1a1-4a3a-bf92-f83600039749",
          "traceId": "8735fe55",
          "type": "GENERATION",
          "name": "8735_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:45:29.585000+00:00",
          "endTime": "2025-08-13T03:45:57.635000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28050.0,
          "environment": "default",
          "completionTokens": 1005,
          "totalTokens": 3053,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-46-05-779614_chatcmpl-cfc3f01c-2776-4c57-a75c-9924c451bec4",
          "traceId": "8735fe55",
          "type": "GENERATION",
          "name": "8735_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:46:05.779000+00:00",
          "endTime": "2025-08-13T03:46:36.514000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30735.0,
          "environment": "default",
          "completionTokens": 1109,
          "totalTokens": 3157,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-46-44-041311_chatcmpl-c6a680a7-95c2-4b13-b7a7-778bddf5bbf3",
          "traceId": "8735fe55",
          "type": "GENERATION",
          "name": "8735_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:46:44.041000+00:00",
          "endTime": "2025-08-13T03:47:11.823000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27782.0,
          "environment": "default",
          "completionTokens": 993,
          "totalTokens": 3041,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "389670bb-4625-4338-8a87-707990ae64c7",
          "traceId": "8735fe55",
          "type": "SPAN",
          "name": "error_87_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:47:20.113000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_55299f2d_1755056831.py\", line 66, in <module>\n    if scores > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:47:25.251Z",
      "createdAt": "2025-08-13T03:44:20.054Z"
    },
    {
      "id": "86ddf27b",
      "timestamp": "2025-08-13T03:40:55.679000+00:00",
      "name": "86dd_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nconfidence_threshold  = 0.5\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Initialize Video Capture and Writer\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Input Acquisition & Preprocessing Loop\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocess Data\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n   if input_data_type == np.float32:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Get Output Tensor\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n\n   # Interpret Results\n   boxes = output_data[0, ..., 1:5]\n   classes = output_data[0, ..., 5]\n   scores = output_data[0, ..., 6]\n\n   # Post-processing\n   for i in range(boxes.shape[0]):\n       if scores[i] > confidence_threshold:\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame_width)\n           xmax = int(xmax * frame_width)\n           ymin = int(ymin * frame_height)\n           ymax = int(ymax * frame_height)\n\n           class_id = int(classes[i])\n           label = labels[class_id]\n           confidence = scores[i]\n\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           cv2.putText(frame, f'{label}: {confidence:.2f}', (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   # Handle Output\n   out.write(frame)\n\n# Cleanup\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_82ecdac0_1755056643.py\", line 64, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 22
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 195.792,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-40-55-681077_chatcmpl-ca57e2a1-3aef-4657-8972-0ff766b53681",
          "traceId": "86ddf27b",
          "type": "GENERATION",
          "name": "86dd_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:40:55.681000+00:00",
          "endTime": "2025-08-13T03:41:22.151000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26470.0,
          "environment": "default",
          "completionTokens": 943,
          "totalTokens": 2909,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-41-30-183554_chatcmpl-71e2d82b-75a9-4f46-91f0-230c8eafe41e",
          "traceId": "86ddf27b",
          "type": "GENERATION",
          "name": "86dd_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:41:30.183000+00:00",
          "endTime": "2025-08-13T03:42:04.519000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 34336.0,
          "environment": "default",
          "completionTokens": 1249,
          "totalTokens": 3297,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-42-12-613941_chatcmpl-ca3c5832-e0b2-42c9-830d-29943592266a",
          "traceId": "86ddf27b",
          "type": "GENERATION",
          "name": "86dd_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:42:12.613000+00:00",
          "endTime": "2025-08-13T03:42:44.298000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31685.0,
          "environment": "default",
          "completionTokens": 1146,
          "totalTokens": 3194,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-42-52-430342_chatcmpl-fab0c5a3-58ea-4f33-9af3-38c8afd08318",
          "traceId": "86ddf27b",
          "type": "GENERATION",
          "name": "86dd_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:42:52.430000+00:00",
          "endTime": "2025-08-13T03:43:22.825000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30395.0,
          "environment": "default",
          "completionTokens": 1095,
          "totalTokens": 3143,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-43-31-006582_chatcmpl-d14ac450-b472-4662-aeb5-16d07cf57220",
          "traceId": "86ddf27b",
          "type": "GENERATION",
          "name": "86dd_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:43:31.006000+00:00",
          "endTime": "2025-08-13T03:44:03.444000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32438.0,
          "environment": "default",
          "completionTokens": 1173,
          "totalTokens": 3221,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "bea1e062-28b1-4cdf-8041-6b42ca3671ec",
          "traceId": "86ddf27b",
          "type": "SPAN",
          "name": "error_86_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:44:11.473000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_82ecdac0_1755056643.py\", line 64, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:44:16.909Z",
      "createdAt": "2025-08-13T03:40:56.200Z"
    },
    {
      "id": "f836fb10",
      "timestamp": "2025-08-13T03:37:26.069000+00:00",
      "name": "f836_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Main Loop\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if input_data_type == np.float32:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n   else:\n       input_data = np.uint8(input_data)\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Post-processing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0, ..., 0:4]\n   classes = output_data[0, ..., 4]\n   scores = output_data[0, ..., 5]\n\n   threshold = 0.5\n\n   for i in range(len(scores)):\n       if scores[i] > threshold:\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame_width)\n           ymin = int(ymin * frame_height)\n           xmax = int(xmax * frame_width)\n           ymax = int(ymax * frame_height)\n\n           class_id = int(classes[i])\n           label = labels[class_id]\n\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           cv2.putText(frame, f\"{label}: {scores[i]:.2f}\", (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_ac809288_1755056441.py\", line 66, in <module>\n    classes = output_data[0, ..., 4]\nIndexError: index 4 is out of bounds for axis 2 with size 4"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 21
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 203.206,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-37-26-071534_chatcmpl-c7f49af0-f0c1-444b-b98f-d6deb7ac7120",
          "traceId": "f836fb10",
          "type": "GENERATION",
          "name": "f836_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:37:26.071000+00:00",
          "endTime": "2025-08-13T03:37:52.229000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26158.0,
          "environment": "default",
          "completionTokens": 932,
          "totalTokens": 2898,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-38-00-307850_chatcmpl-875a97ba-26e0-4eef-a35e-48a55060e6f0",
          "traceId": "f836fb10",
          "type": "GENERATION",
          "name": "f836_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:38:00.307000+00:00",
          "endTime": "2025-08-13T03:38:33.278000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32971.0,
          "environment": "default",
          "completionTokens": 1196,
          "totalTokens": 3244,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-38-41-360128_chatcmpl-bb76f2d0-f856-419a-8f76-0a8f1289db4a",
          "traceId": "f836fb10",
          "type": "GENERATION",
          "name": "f836_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:38:41.360000+00:00",
          "endTime": "2025-08-13T03:39:20.794000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 39434.0,
          "environment": "default",
          "completionTokens": 1447,
          "totalTokens": 3495,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-39-28-887432_chatcmpl-b9c1343c-4f1d-4f62-8b79-533e8d79a0d8",
          "traceId": "f836fb10",
          "type": "GENERATION",
          "name": "f836_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:39:28.887000+00:00",
          "endTime": "2025-08-13T03:39:58.527000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29640.0,
          "environment": "default",
          "completionTokens": 1067,
          "totalTokens": 3115,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-40-06-593943_chatcmpl-8d799d9e-5732-4e53-b777-ddae8ae2ce76",
          "traceId": "f836fb10",
          "type": "GENERATION",
          "name": "f836_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:40:06.593000+00:00",
          "endTime": "2025-08-13T03:40:41.286000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 34693.0,
          "environment": "default",
          "completionTokens": 1261,
          "totalTokens": 3309,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "c0d48d8d-34cb-473a-a58a-b01c9a35c031",
          "traceId": "f836fb10",
          "type": "SPAN",
          "name": "error_f8_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:40:49.277000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_ac809288_1755056441.py\", line 66, in <module>\n    classes = output_data[0, ..., 4]\nIndexError: index 4 is out of bounds for axis 2 with size 4",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:40:54.813Z",
      "createdAt": "2025-08-13T03:37:26.591Z"
    },
    {
      "id": "80c14300",
      "timestamp": "2025-08-13T03:34:22.405000+00:00",
      "name": "80c1_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "<complete_code>\nimport cv2\nimport numpy as np\nfrom tf_lite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n    interpreter = Interpreter(model_path=model_path,\n                              experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n    interpreter = Interpreter(model_path=model_path,\n                              experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensor()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n    print(\"Error opening video file\")\n    exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Input Acquisition & Preprocessing Loop\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Resize and Preprocess Frame\n    resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(resized_frame, axis=0)\n\n    # Correct data type conversion based on model input\n    if input_data_type == np.float32:\n        input_data = (np.float32(input_data) - 127.5) / 127.5\n    elif input_data_type == np.uint8:\n        input_data = input_data.astype(np.float32) / 255.0\n    else:\n        input_data = input_data.astype(np.float32)\n\n    # Inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get Output\n    output_data = interpreter.get_tensor(output_details[0]['index'])\n    boxes = output_data[0][0:4]\n    classes = output_data[0][4]\n    scores = output_data[0][5]\n\n    # Post-processing\n    confidence_threshold = 0.5\n    if scores > confidence_threshold:\n        xmin = int(boxes[0] * frame_width)\n        ymin = int(boxes[1] * frame_height)\n        xmax = int(boxes[2] * frame_width)\n        ymax = int(boxes[3] * frame_height)\n        class_id = int(classes)\n\n        label = labels[class_id]\n        confidence = scores\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n        cv2.putText(frame, f'{label}: {confidence:.2f}', (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write to Output Video\n    out.write(frame)\n\n# Cleanup\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "  File \"script_e6ef48b9_1755056235.py\", line 1\n    <complete_code>\n    ^\nSyntaxError: invalid syntax"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 20
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 177.592,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-34-22-407485_chatcmpl-6156452a-a72c-4d5f-b3d0-feacffb9feb4",
          "traceId": "80c14300",
          "type": "GENERATION",
          "name": "80c1_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:34:22.407000+00:00",
          "endTime": "2025-08-13T03:34:49.391000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26984.0,
          "environment": "default",
          "completionTokens": 963,
          "totalTokens": 2929,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-34-57-328218_chatcmpl-9701f069-10b0-42e9-83fe-bb75773b9ce5",
          "traceId": "80c14300",
          "type": "GENERATION",
          "name": "80c1_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:34:57.328000+00:00",
          "endTime": "2025-08-13T03:35:29.096000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31768.0,
          "environment": "default",
          "completionTokens": 1148,
          "totalTokens": 3196,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-35-36-838708_chatcmpl-ddf0c6ac-49c9-45b4-9c62-968409128278",
          "traceId": "80c14300",
          "type": "GENERATION",
          "name": "80c1_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:35:36.838000+00:00",
          "endTime": "2025-08-13T03:36:09.098000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32260.0,
          "environment": "default",
          "completionTokens": 1166,
          "totalTokens": 3214,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-36-12-914508_chatcmpl-af05f1f9-1623-4153-a49e-29825a4c2714",
          "traceId": "80c14300",
          "type": "GENERATION",
          "name": "80c1_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:36:12.914000+00:00",
          "endTime": "2025-08-13T03:36:42.858000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29944.0,
          "environment": "default",
          "completionTokens": 1079,
          "totalTokens": 3127,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-36-46-730401_chatcmpl-ee198a77-2e95-489b-8b78-055bb3682e74",
          "traceId": "80c14300",
          "type": "GENERATION",
          "name": "80c1_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:36:46.730000+00:00",
          "endTime": "2025-08-13T03:37:15.911000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29181.0,
          "environment": "default",
          "completionTokens": 1048,
          "totalTokens": 3096,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "42834b15-d5c4-40ac-b30d-6407e506f2ba",
          "traceId": "80c14300",
          "type": "SPAN",
          "name": "error_80_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:37:19.999000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error:   File \"script_e6ef48b9_1755056235.py\", line 1\n    <complete_code>\n    ^\nSyntaxError: invalid syntax",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:37:25.199Z",
      "createdAt": "2025-08-13T03:34:22.925Z"
    },
    {
      "id": "46aa2a73",
      "timestamp": "2025-08-13T03:31:00.155000+00:00",
      "name": "46aa_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nconfidence_threshold  = 0.5\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Initialize Video Capture and Output Writer\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file.\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')  # or use 'XVID'\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocess Data\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Run Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Get Output\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n\n   # Interpret Results\n   boxes = output_data[0]  # Corrected line\n   classes = output_data[1]  # Corrected line\n   scores = output_data[2]  # Corrected line\n\n   # Post-processing\n   for i in range(len(scores)):\n       if scores[i] > confidence_threshold:\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame_width)\n           xmax = int(xmax * frame_width)\n           ymin = int(ymin * frame_height)\n           ymax = int(ymax * frame_height)\n\n           label_id = int(classes[i])\n           label = labels[label_id]\n\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           cv2.putText(frame, f'{label}: {scores[i]:.2f}', (xmin, ymin - 10),\n                       cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   # Write to output video\n   out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_e4fed3d0_1755056046.py\", line 64, in <module>\n    classes = output_data[1]  # Corrected line\nIndexError: index 1 is out of bounds for axis 0 with size 1"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 19
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 194.539,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-31-00-157013_chatcmpl-cbe92318-ee44-4c98-ae35-19f89c2187a5",
          "traceId": "46aa2a73",
          "type": "GENERATION",
          "name": "46aa_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:31:00.157000+00:00",
          "endTime": "2025-08-13T03:31:27.130000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26973.0,
          "environment": "default",
          "completionTokens": 959,
          "totalTokens": 2925,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-31-35-173495_chatcmpl-c864ecc5-8768-47c9-923e-2110ba4f5989",
          "traceId": "46aa2a73",
          "type": "GENERATION",
          "name": "46aa_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:31:35.173000+00:00",
          "endTime": "2025-08-13T03:32:06.722000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31549.0,
          "environment": "default",
          "completionTokens": 1141,
          "totalTokens": 3189,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-32-14-881136_chatcmpl-fde261fb-1ee9-4c1a-8ada-896bf6e737e7",
          "traceId": "46aa2a73",
          "type": "GENERATION",
          "name": "46aa_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:32:14.881000+00:00",
          "endTime": "2025-08-13T03:32:46.949000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32068.0,
          "environment": "default",
          "completionTokens": 1162,
          "totalTokens": 3210,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-32-55-034016_chatcmpl-e6217e4f-44c6-4364-8573-e47ba0110e26",
          "traceId": "46aa2a73",
          "type": "GENERATION",
          "name": "46aa_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:32:55.034000+00:00",
          "endTime": "2025-08-13T03:33:27.311000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32277.0,
          "environment": "default",
          "completionTokens": 1170,
          "totalTokens": 3218,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-33-35-389054_chatcmpl-274dbdd6-25d2-400f-a1dc-6bb02d4867af",
          "traceId": "46aa2a73",
          "type": "GENERATION",
          "name": "46aa_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:33:35.389000+00:00",
          "endTime": "2025-08-13T03:34:06.642000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31253.0,
          "environment": "default",
          "completionTokens": 1129,
          "totalTokens": 3177,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "4df7d56d-6fde-4240-9d02-bc1eeaa23ccc",
          "traceId": "46aa2a73",
          "type": "SPAN",
          "name": "error_46_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:34:14.696000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_e4fed3d0_1755056046.py\", line 64, in <module>\n    classes = output_data[1]  # Corrected line\nIndexError: index 1 is out of bounds for axis 0 with size 1",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:34:19.867Z",
      "createdAt": "2025-08-13T03:31:00.676Z"
    },
    {
      "id": "9d4b96e2",
      "timestamp": "2025-08-13T03:27:52.023000+00:00",
      "name": "9d4b_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video stream or file\")\n   exit()\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\n# Inference Loop\nwhile(cap.isOpened()):\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n   if input_data_type == np.float32:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n   else:\n       input_data = np.uint8(input_data)\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Post-processing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   scores = output_data[0][5]\n\n   confidence_threshold = 0.5\n   if scores > confidence_threshold: #This line caused the error. scores is a numpy array\n       x0, y0, x1, y1 = boxes\n       class_id = int(classes)\n       label = labels[class_id]\n       confidence = scores\n\n       cv2.rectangle(frame, (int(x0), int(y0)), (int(x1), int(y1)), (0, 255, 0), 2)\n       cv2.putText(frame, f\"{label}: {confidence:.2f}\", (int(x0), int(y0) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_fafb92d5_1755055845.py\", line 65, in <module>\n    if scores > confidence_threshold: #This line caused the error. scores is a numpy array\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 18
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 182.02,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-27-52-024632_chatcmpl-4a30ce68-a7b7-4103-8a51-7295e0261b05",
          "traceId": "9d4b96e2",
          "type": "GENERATION",
          "name": "9d4b_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:27:52.024000+00:00",
          "endTime": "2025-08-13T03:28:16.470000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 24446.0,
          "environment": "default",
          "completionTokens": 866,
          "totalTokens": 2832,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-28-24-921935_chatcmpl-ac8c1df2-2feb-4fa9-8acd-132db4c8c0cd",
          "traceId": "9d4b96e2",
          "type": "GENERATION",
          "name": "9d4b_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:28:24.921000+00:00",
          "endTime": "2025-08-13T03:28:55.698000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30777.0,
          "environment": "default",
          "completionTokens": 1109,
          "totalTokens": 3157,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-29-03-106017_chatcmpl-2a7da485-1014-4455-bca0-7f3f243a8c6d",
          "traceId": "9d4b96e2",
          "type": "GENERATION",
          "name": "9d4b_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:29:03.106000+00:00",
          "endTime": "2025-08-13T03:29:30.153000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27047.0,
          "environment": "default",
          "completionTokens": 966,
          "totalTokens": 3014,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-29-38-353869_chatcmpl-ac77f89d-492b-4aa8-abde-1119dd077a0a",
          "traceId": "9d4b96e2",
          "type": "GENERATION",
          "name": "9d4b_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:29:38.353000+00:00",
          "endTime": "2025-08-13T03:30:08.189000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29836.0,
          "environment": "default",
          "completionTokens": 1073,
          "totalTokens": 3121,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-30-16-381527_chatcmpl-27b87a3a-13a9-4f58-9cff-787005c8bbfe",
          "traceId": "9d4b96e2",
          "type": "GENERATION",
          "name": "9d4b_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:30:16.381000+00:00",
          "endTime": "2025-08-13T03:30:45.953000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29572.0,
          "environment": "default",
          "completionTokens": 1065,
          "totalTokens": 3113,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "88e9f5b6-4868-4aef-a065-426b232d9050",
          "traceId": "9d4b96e2",
          "type": "SPAN",
          "name": "error_9d_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:30:54.044000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_fafb92d5_1755055845.py\", line 65, in <module>\n    if scores > confidence_threshold: #This line caused the error. scores is a numpy array\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:30:59.289Z",
      "createdAt": "2025-08-13T03:27:52.543Z"
    },
    {
      "id": "cd923ebe",
      "timestamp": "2025-08-13T03:24:40.865000+00:00",
      "name": "cd92_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n interpreter = Interpreter(model_path=model_path,\n                          experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n interpreter = Interpreter(model_path=model_path,\n                          experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Input Acquisition & Preprocessing Loop\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n print(\"Error opening video file\")\n exit()\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile True:\n ret, frame = cap.read()\n if not ret:\n  break\n\n # Resize and Preprocess\n resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n input_data = np.expand_dims(resized_frame, axis=0)\n if floating_model:\n  input_data = (np.float32(input_data) - 127.5) / 127.5\n\n # Inference\n interpreter.set_tensor(input_details[0]['index'], input_data)\n interpreter.invoke()\n\n # Get Output\n output_data = interpreter.get_tensor(output_details[0]['index'])\n\n # Interpret Results\n boxes = output_data[0][0:4]\n classes = output_data[0][4]\n scores = output_data[0][5]\n\n # Post-processing\n confidence_threshold = 0.5\n if scores > confidence_threshold:\n  class_id = int(classes)\n  label = labels[class_id]\n  x1, y1, x2, y2 = boxes\n  x1, y1, x2, y2 = int(x1 * frame.shape[1]), int(y1 * frame.shape[0]), int(x2 * frame.shape[1]), int(y2 * frame.shape[0])\n\n  cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n  cv2.putText(frame, f\"{label}: {scores:.2f}\", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_43e2f5ee_1755055656.py\", line 65, in <module>\n    if scores > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 17
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 184.157,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-24-40-866968_chatcmpl-ce21af30-8313-44ff-bc39-f0dd009bc79d",
          "traceId": "cd923ebe",
          "type": "GENERATION",
          "name": "cd92_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:24:40.866000+00:00",
          "endTime": "2025-08-13T03:25:05.890000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 25024.0,
          "environment": "default",
          "completionTokens": 887,
          "totalTokens": 2853,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-25-14-023336_chatcmpl-3ea3e7e4-c01f-4817-9de5-ce9d4109a71b",
          "traceId": "cd923ebe",
          "type": "GENERATION",
          "name": "cd92_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:25:14.023000+00:00",
          "endTime": "2025-08-13T03:25:44.856000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30833.0,
          "environment": "default",
          "completionTokens": 1112,
          "totalTokens": 3160,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-25-52-867931_chatcmpl-cc481cb7-1647-42a0-8a0a-0ecc2cc3309e",
          "traceId": "cd923ebe",
          "type": "GENERATION",
          "name": "cd92_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:25:52.867000+00:00",
          "endTime": "2025-08-13T03:26:23.073000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30206.0,
          "environment": "default",
          "completionTokens": 1089,
          "totalTokens": 3137,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-26-31-216314_chatcmpl-9caeaf1a-85c5-4568-a022-3d0ead6f1293",
          "traceId": "cd923ebe",
          "type": "GENERATION",
          "name": "cd92_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:26:31.216000+00:00",
          "endTime": "2025-08-13T03:26:59.719000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28503.0,
          "environment": "default",
          "completionTokens": 1022,
          "totalTokens": 3070,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-27-07-849359_chatcmpl-91f759f3-5cf0-4675-8d73-c25249ca90e4",
          "traceId": "cd923ebe",
          "type": "GENERATION",
          "name": "cd92_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:27:07.849000+00:00",
          "endTime": "2025-08-13T03:27:36.986000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29137.0,
          "environment": "default",
          "completionTokens": 1046,
          "totalTokens": 3094,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "62ddae28-c2b4-4d92-882e-0cfc44ce6bd9",
          "traceId": "cd923ebe",
          "type": "SPAN",
          "name": "error_cd_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:27:45.023000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_43e2f5ee_1755055656.py\", line 65, in <module>\n    if scores > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:27:50.667Z",
      "createdAt": "2025-08-13T03:24:41.385Z"
    },
    {
      "id": "613e3500",
      "timestamp": "2025-08-13T03:21:19.987000+00:00",
      "name": "613e_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Initialize Video Capture\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\n# Get video properties\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfps = int(cap.get(cv2.CAP_PROP_FPS))\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, fps, (frame_width, frame_height))\n\n# Detection Threshold\ndetection_threshold = 0.5\n\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Resize and Preprocess Frame\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Set Input Tensor\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n\n   # Run Inference\n   interpreter.invoke()\n\n   # Get Output Tensor\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n\n   # Process Output\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   scores = output_data[0][5]\n\n   if scores > detection_threshold:\n       x1 = int(boxes[0] * frame_width)\n       y1 = int(boxes[1] * frame_height)\n       x2 = int(boxes[2] * frame_width)\n       y2 = int(boxes[3] * frame_height)\n\n       class_id = int(classes)\n       class_name = labels[class_id]\n       score = scores\n       cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n       cv2.putText(frame, f\"{class_name}: {score:.2f}\", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n   # Write the processed frame to the output video\n   out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_fe4378c8_1755055466.py\", line 74, in <module>\n    if scores > detection_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 16
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 194.842,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-21-19-988541_chatcmpl-233198cf-52dc-44af-a7d7-6618d18b56aa",
          "traceId": "613e3500",
          "type": "GENERATION",
          "name": "613e_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:21:19.988000+00:00",
          "endTime": "2025-08-13T03:21:46.579000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26591.0,
          "environment": "default",
          "completionTokens": 948,
          "totalTokens": 2914,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-21-54-691719_chatcmpl-7d9e1950-5599-43e0-a46e-f2ab8a75f038",
          "traceId": "613e3500",
          "type": "GENERATION",
          "name": "613e_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:21:54.691000+00:00",
          "endTime": "2025-08-13T03:22:26.656000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31965.0,
          "environment": "default",
          "completionTokens": 1157,
          "totalTokens": 3205,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-22-34-757396_chatcmpl-8e70ef6d-6987-45bf-8b16-59480999e591",
          "traceId": "613e3500",
          "type": "GENERATION",
          "name": "613e_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:22:34.757000+00:00",
          "endTime": "2025-08-13T03:23:06.316000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31559.0,
          "environment": "default",
          "completionTokens": 1141,
          "totalTokens": 3189,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-23-14-445366_chatcmpl-2abe1ba9-e191-44cc-aaec-e0d8df1bb9ed",
          "traceId": "613e3500",
          "type": "GENERATION",
          "name": "613e_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:23:14.445000+00:00",
          "endTime": "2025-08-13T03:23:45.157000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30712.0,
          "environment": "default",
          "completionTokens": 1107,
          "totalTokens": 3155,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-23-53-152839_chatcmpl-ffa63a20-e2a6-403a-8b86-f824323687e9",
          "traceId": "613e3500",
          "type": "GENERATION",
          "name": "613e_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:23:53.152000+00:00",
          "endTime": "2025-08-13T03:24:26.364000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 33212.0,
          "environment": "default",
          "completionTokens": 1206,
          "totalTokens": 3254,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "718b8f54-63d5-4e6c-8333-5bed88b64c0d",
          "traceId": "613e3500",
          "type": "SPAN",
          "name": "error_61_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:24:34.830000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_fe4378c8_1755055466.py\", line 74, in <module>\n    if scores > detection_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:24:40.233Z",
      "createdAt": "2025-08-13T03:21:20.505Z"
    },
    {
      "id": "470d8057",
      "timestamp": "2025-08-13T03:18:00.970000+00:00",
      "name": "470d_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\n\n# Load labels\ntry:\n    with open(\"/home/mendhak/tinyml_autopilot/models/labelmap.txt\", 'r') as f:\n        labels = [line.strip() for line in f]\nexcept FileNotFoundError:\n    print(\"Label file not found. Using dummy labels.\")\n    labels = [\"object\"]\n\n# Load interpreter\ntry:\n    interpreter = cv2.dnn.readNet(\"/home/mendhak/tinyml_autopilot/models/edgetpu_detect.tflite\")\nexcept Exception as e:\n    print(f\"Error loading interpreter: {e}\")\n    exit()\n\n\n# Video setup\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nconfidence_threshold  = 0.5\n\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n    print(\"Error opening video file\")\n    exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfps = int(cap.get(cv2.CAP_PROP_FPS))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, fps, (frame_width, frame_height))\n\n# Input size for the model.  Adjust if necessary.\ninput_size = (300, 300)  # Example.  Replace with your model's expected input size.\n\n\n# Inference Loop\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocessing\n    resized_frame = cv2.resize(frame, input_size)\n    blob = cv2.dnn.blobFromImage(resized_frame, 1 / 255.0, input_size, swapRB=True, crop=False)\n\n    # Inference\n    interpreter.setInput(blob)\n    output = interpreter.forward()\n\n    # Post-processing\n    boxes = output[0, 0, :, 3:7]\n    classes = output[0, 0, :, 5]\n    scores = output[0, 0, :, 4]\n\n    for i in range(boxes.shape[0]):\n        if scores[i] > confidence_threshold:\n            x, y, w, h = boxes[i]\n            x = int(x * frame_width)\n            y = int(y * frame_height)\n            w = int(w * frame_width)\n            h = int(h * frame_height)\n\n            class_id = int(classes[i])\n            label = labels[class_id]\n\n            cv2.rectangle(frame, (x, y), (x + w, y + h), (0, 255, 0), 2)\n            cv2.putText(frame, f\"{label}: {scores[i]:.2f}\", (x, y - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 15
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 183.804,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-18-00-971709_chatcmpl-617b681b-f452-4ca3-8e65-1d972264cccb",
          "traceId": "470d8057",
          "type": "GENERATION",
          "name": "470d_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:18:00.971000+00:00",
          "endTime": "2025-08-13T03:18:29.476000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28505.0,
          "environment": "default",
          "completionTokens": 1020,
          "totalTokens": 2986,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-18-37-375678_chatcmpl-24f028fa-a56d-4755-97fc-1bd39d048e6e",
          "traceId": "470d8057",
          "type": "GENERATION",
          "name": "470d_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:18:37.375000+00:00",
          "endTime": "2025-08-13T03:19:13.406000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 36031.0,
          "environment": "default",
          "completionTokens": 1316,
          "totalTokens": 3364,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-19-17-528417_chatcmpl-8d02bda7-dd5e-4ebe-8f7f-b3d1951260f0",
          "traceId": "470d8057",
          "type": "GENERATION",
          "name": "470d_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:19:17.528000+00:00",
          "endTime": "2025-08-13T03:19:47.651000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30123.0,
          "environment": "default",
          "completionTokens": 1085,
          "totalTokens": 3133,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-19-55-244310_chatcmpl-92558313-3595-4dac-b9c4-c4aed7cedc04",
          "traceId": "470d8057",
          "type": "GENERATION",
          "name": "470d_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:19:55.244000+00:00",
          "endTime": "2025-08-13T03:20:27.291000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32047.0,
          "environment": "default",
          "completionTokens": 1160,
          "totalTokens": 3208,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-20-34-951333_chatcmpl-8a8311ce-7b2a-4635-badb-9cf5fc3baea4",
          "traceId": "470d8057",
          "type": "GENERATION",
          "name": "470d_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:20:34.951000+00:00",
          "endTime": "2025-08-13T03:21:04.775000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29824.0,
          "environment": "default",
          "completionTokens": 1071,
          "totalTokens": 3119,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:21:17.669Z",
      "createdAt": "2025-08-13T03:18:01.489Z"
    },
    {
      "id": "a7b08e90",
      "timestamp": "2025-08-13T03:16:08.400000+00:00",
      "name": "a7b0_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\n\n# Model and video paths\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nlabels = [\"sheep\"]  # Define labels for object detection\n\n# Initialize the TensorFlow interpreter\ntry:\n    interpreter = tf.lite.Interpreter(model_path=model_path)\n    interpreter.allocate_tensors()\nexcept Exception as e:\n    print(f\"Error loading the model: {e}\")\n    exit()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Get input shape\ninput_shape = input_details[0]['shape']\n\n# Initialize Video Capture\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n    print(\"Error opening video file\")\n    exit()\n\n# Get video properties\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfps = int(cap.get(cv2.CAP_PROP_FPS))\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, fps, (frame_width, frame_height))\n\n# Inference Loop\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocessing\n    resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(resized_frame, axis=0)\n    input_data = input_data.astype(np.float32)  # Convert to float32\n\n    # Perform inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Post-processing\n    output_data = interpreter.get_tensor(output_details[0]['index'])\n    boxes = output_data[0, ..., 0:4]\n    classes = output_data[0, ..., 4]\n    scores = output_data[0, ..., 5]\n\n    confidence_threshold = 0.5\n    for i in range(boxes.shape[0]):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            xmin = int(xmin * frame_width)\n            xmax = int(xmax * frame_width)\n            ymin = int(ymin * frame_height)\n            ymax = int(ymax * frame_height)\n\n            class_id = int(classes[i])\n            label = labels[class_id]\n            confidence = scores[i]\n\n            cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n            label_text = f\"{label}: {confidence:.2f}\"\n            cv2.putText(frame, label_text, (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write the frame to the output video\n    out.write(frame)\n\n    # Display the resulting frame\n    cv2.imshow('Object Detection', frame)\n\n    # Press Q on keyboard to exit\n    if cv2.waitKey(25) & 0xFF == ord('q'):\n        break\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 14
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 99.359,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-16-08-402290_chatcmpl-01463b6c-b445-47d2-92ec-96eef4a308c1",
          "traceId": "a7b08e90",
          "type": "GENERATION",
          "name": "a7b0_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:16:08.402000+00:00",
          "endTime": "2025-08-13T03:16:37.054000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28652.0,
          "environment": "default",
          "completionTokens": 1026,
          "totalTokens": 2992,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-16-45-108193_chatcmpl-86f3fc1a-2121-4c6e-88f6-755abe4cd8bb",
          "traceId": "a7b08e90",
          "type": "GENERATION",
          "name": "a7b0_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:16:45.108000+00:00",
          "endTime": "2025-08-13T03:17:11.444000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26336.0,
          "environment": "default",
          "completionTokens": 940,
          "totalTokens": 2988,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-17-15-382170_chatcmpl-9e05f0af-b971-4c1e-a23a-774533a77489",
          "traceId": "a7b08e90",
          "type": "GENERATION",
          "name": "a7b0_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:17:15.382000+00:00",
          "endTime": "2025-08-13T03:17:47.761000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32379.0,
          "environment": "default",
          "completionTokens": 1174,
          "totalTokens": 3222,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:18:00.620Z",
      "createdAt": "2025-08-13T03:16:08.919Z"
    },
    {
      "id": "7be24bc5",
      "timestamp": "2025-08-13T03:12:49.770000+00:00",
      "name": "7be2_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\n# input_data = np.array(np.random.rand(1, input_shape[1], input_shape[2], 3), dtype=np.float32)\n\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Input Acquisition & Preprocessing Loop\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Resize and Preprocess\n   resized_frame = cv2.resize(frame, (300, 300))  # Assuming model input size is 300x300\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Get Output\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n\n   # Interpret Results\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   scores = output_data[0][5]\n\n   # Post-processing\n   confidence_threshold = 0.5\n   if scores > confidence_threshold:\n       predicted_class = labels[int(classes)]\n       x1, y1, x2, y2 = boxes\n       x1, y1, x2, y2 = int(x1 * frame.shape[1]), int(y1 * frame.shape[0]), int(x2 * frame.shape[1]), int(\n           y2 * frame.shape[0])\n       cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n       cv2.putText(frame, f'{predicted_class}: {scores:.2f}', (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9,\n                   (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_78854782_1755054954.py\", line 69, in <module>\n    if scores > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 13
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 192.537,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-12-49-772439_chatcmpl-eaf5c316-4211-4e07-9925-05b3b3f9875c",
          "traceId": "7be24bc5",
          "type": "GENERATION",
          "name": "7be2_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:12:49.772000+00:00",
          "endTime": "2025-08-13T03:13:16.091000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26319.0,
          "environment": "default",
          "completionTokens": 936,
          "totalTokens": 2902,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-13-24-486160_chatcmpl-6a9064d9-9a5b-42e3-8e86-defc35bd5692",
          "traceId": "7be24bc5",
          "type": "GENERATION",
          "name": "7be2_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:13:24.486000+00:00",
          "endTime": "2025-08-13T03:13:56.551000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32065.0,
          "environment": "default",
          "completionTokens": 1159,
          "totalTokens": 3207,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-14-04-646853_chatcmpl-dbd11cce-7aad-4883-b984-8f2e33d38ff1",
          "traceId": "7be24bc5",
          "type": "GENERATION",
          "name": "7be2_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:14:04.646000+00:00",
          "endTime": "2025-08-13T03:14:34.999000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30353.0,
          "environment": "default",
          "completionTokens": 1094,
          "totalTokens": 3142,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-14-43-058775_chatcmpl-f985db63-8af4-451a-8445-dd7441f4cdc3",
          "traceId": "7be24bc5",
          "type": "GENERATION",
          "name": "7be2_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:14:43.058000+00:00",
          "endTime": "2025-08-13T03:15:15.704000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32646.0,
          "environment": "default",
          "completionTokens": 1185,
          "totalTokens": 3233,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-15-24-013188_chatcmpl-12ce2d01-f24e-45f1-801c-9c49bc900030",
          "traceId": "7be24bc5",
          "type": "GENERATION",
          "name": "7be2_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:15:24.013000+00:00",
          "endTime": "2025-08-13T03:15:54.236000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30223.0,
          "environment": "default",
          "completionTokens": 1089,
          "totalTokens": 3137,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "824ee57a-e8f9-4cd1-a62e-b4f8b6486ece",
          "traceId": "7be24bc5",
          "type": "SPAN",
          "name": "error_7b_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:16:02.309000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_78854782_1755054954.py\", line 69, in <module>\n    if scores > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:16:07.557Z",
      "createdAt": "2025-08-13T03:12:50.289Z"
    },
    {
      "id": "5f1d4ea8",
      "timestamp": "2025-08-13T03:09:46.034000+00:00",
      "name": "5f1d_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\n# Allocate memory for tensors\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Main Loop\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n   if input_data_type == np.float32:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Post-processing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   scores = output_data[0][5]\n\n   if scores > 0.5:\n       ymin, xmin, ymax, xmax = boxes\n       xmin = int(xmin * frame_width)\n       xmax = int(xmax * frame_width)\n       ymin = int(ymin * frame_height)\n       ymax = int(ymax * frame_height)\n       class_id = int(classes)\n       label = labels[class_id]\n       cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n       cv2.putText(frame, f\"{label}: {scores:.2f}\", (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_69347d72_1755054755.py\", line 63, in <module>\n    if scores > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 12
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 177.481,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-09-46-036078_chatcmpl-d7e9f08f-65b7-4151-a1d7-b0e4b2ef4a35",
          "traceId": "5f1d4ea8",
          "type": "GENERATION",
          "name": "5f1d_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:09:46.036000+00:00",
          "endTime": "2025-08-13T03:10:10.495000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 24459.0,
          "environment": "default",
          "completionTokens": 866,
          "totalTokens": 2832,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-10-18-574449_chatcmpl-cef91cc2-dbb0-444e-a14d-6ba822e40bbc",
          "traceId": "5f1d4ea8",
          "type": "GENERATION",
          "name": "5f1d_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:10:18.574000+00:00",
          "endTime": "2025-08-13T03:10:46.804000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28230.0,
          "environment": "default",
          "completionTokens": 1011,
          "totalTokens": 3059,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-10-54-886443_chatcmpl-9c3856f6-ded8-4a9b-a0d4-d8970dd3d628",
          "traceId": "5f1d4ea8",
          "type": "GENERATION",
          "name": "5f1d_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:10:54.886000+00:00",
          "endTime": "2025-08-13T03:11:25.011000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30125.0,
          "environment": "default",
          "completionTokens": 1086,
          "totalTokens": 3134,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-11-33-006994_chatcmpl-0d26f139-72d5-4bb9-afcf-9cce258f1d0f",
          "traceId": "5f1d4ea8",
          "type": "GENERATION",
          "name": "5f1d_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:11:33.006000+00:00",
          "endTime": "2025-08-13T03:12:00.899000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27893.0,
          "environment": "default",
          "completionTokens": 998,
          "totalTokens": 3046,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-12-08-272133_chatcmpl-6bc5389e-1573-432b-a1a2-62ddcefad4e7",
          "traceId": "5f1d4ea8",
          "type": "GENERATION",
          "name": "5f1d_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:12:08.272000+00:00",
          "endTime": "2025-08-13T03:12:35.402000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27130.0,
          "environment": "default",
          "completionTokens": 971,
          "totalTokens": 3019,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "3bbf92a2-fb58-45a0-a1e4-d6db72af942b",
          "traceId": "5f1d4ea8",
          "type": "SPAN",
          "name": "error_5f_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:12:43.517000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_69347d72_1755054755.py\", line 63, in <module>\n    if scores > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:12:48.790Z",
      "createdAt": "2025-08-13T03:09:46.552Z"
    },
    {
      "id": "62d8652c",
      "timestamp": "2025-08-13T03:06:35.919000+00:00",
      "name": "62d8_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tflite_runtime.interpreter as tflite\n\n# Define paths\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nlabels = [\"sheep\"]  # Replace with your labels\n\n# Load the TFLite model\ninterpreter = tflite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()  # Corrected method name\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n    print(\"Error opening video file\")\n    exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfps = int(cap.get(cv2.CAP_PROP_FPS))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, fps, (frame_width, frame_height))\n\n# Inference Loop\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocessing\n    resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(resized_frame, axis=0)\n\n    if floating_model:\n        input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Postprocessing\n    output_data = interpreter.get_tensor(output_details[0]['index'])\n    boxes = output_data[0, ..., 1:5]\n    classes = output_data[0, ..., 5]\n    scores = output_data[0, ..., 6]\n\n    # Confidence Thresholding\n    confidence_threshold = 0.5\n    valid_detections = scores > confidence_threshold\n    filtered_boxes = boxes[valid_detections]\n    filtered_classes = classes[valid_detections].astype(np.int32)\n    filtered_scores = scores[valid_detections]\n\n    # Draw Bounding Boxes\n    for i in range(len(filtered_boxes)):\n        box = filtered_boxes[i]\n        class_id = filtered_classes[i]\n        score = filtered_scores[i]\n\n        x1 = int(box[0] * frame_width)\n        y1 = int(box[1] * frame_height)\n        x2 = int(box[2] * frame_width)\n        y2 = int(box[3] * frame_height)\n\n        label = f\"{labels[class_id]}: {score:.2f}\"\n\n        cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n        cv2.putText(frame, label, (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write Output\n    out.write(frame)\n\n# Release Resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_c5f7a06d_1755054571.py\", line 55, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 11
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 183.409,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-06-06-35-920904_chatcmpl-f7aa2816-5501-418b-adac-1ae2d98bba3d",
          "traceId": "62d8652c",
          "type": "GENERATION",
          "name": "62d8_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T03:06:35.920000+00:00",
          "endTime": "2025-08-13T03:07:04.212000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28292.0,
          "environment": "default",
          "completionTokens": 1013,
          "totalTokens": 2979,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-07-12-341788_chatcmpl-7775233e-4c64-42f3-9294-174831b2eeb3",
          "traceId": "62d8652c",
          "type": "GENERATION",
          "name": "62d8_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T03:07:12.341000+00:00",
          "endTime": "2025-08-13T03:07:42.263000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29922.0,
          "environment": "default",
          "completionTokens": 1077,
          "totalTokens": 3125,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-07-46-134741_chatcmpl-bddc1eff-6051-4bb2-9ad2-a4f1ca4e3cc3",
          "traceId": "62d8652c",
          "type": "GENERATION",
          "name": "62d8_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T03:07:46.134000+00:00",
          "endTime": "2025-08-13T03:08:16.289000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30155.0,
          "environment": "default",
          "completionTokens": 1085,
          "totalTokens": 3133,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-08-24-430892_chatcmpl-e6034fc4-91b4-4ec9-8407-af288a18219f",
          "traceId": "62d8652c",
          "type": "GENERATION",
          "name": "62d8_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:08:24.430000+00:00",
          "endTime": "2025-08-13T03:08:52.186000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27756.0,
          "environment": "default",
          "completionTokens": 992,
          "totalTokens": 3040,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-09-00-364498_chatcmpl-e1dc0c6f-b0c2-47fa-a2c8-82afc7a1a511",
          "traceId": "62d8652c",
          "type": "GENERATION",
          "name": "62d8_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:09:00.364000+00:00",
          "endTime": "2025-08-13T03:09:31.131000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30767.0,
          "environment": "default",
          "completionTokens": 1109,
          "totalTokens": 3157,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "75a8e505-8aaf-41a0-8d1c-bfc9cb4e73f1",
          "traceId": "62d8652c",
          "type": "SPAN",
          "name": "error_62_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:09:39.329000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_c5f7a06d_1755054571.py\", line 55, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:09:44.681Z",
      "createdAt": "2025-08-13T03:06:36.436Z"
    },
    {
      "id": "38b6e653",
      "timestamp": "2025-08-13T01:24:06.131000+00:00",
      "name": "38b6_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\n\n# Define paths\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nlabels = ['sheep', 'background']\n\n# Initialize the interpreter\ninterpreter = Interpreter(model_path=model_path)\ninterpreter.allocate_tensor()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Input shape and dtype\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Initialize video capture\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n    print(\"Error opening video file\")\n    exit()\n\n# Get video properties\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Main loop\nwhile True:\n    # Read a frame from the video\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Resize and preprocess the frame\n    resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(resized_frame, axis=0)\n\n    # Normalize the input data if the model expects it\n    if input_data_type == np.float32:\n        input_data = input_data.astype(np.float32) / 255.0\n    elif input_data_type == np.uint8:\n        input_data = input_data.astype(np.uint8)\n    else:\n        print(f\"Unsupported input data type: {input_data_type}\")\n        exit()\n\n    # Set the input tensor\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Get the output tensor\n    output_data = interpreter.get_tensor(output_details[0]['index'])\n\n    # Post-processing\n    boxes = output_data[0][0:4]\n    classes = output_data[0][4]\n    scores = output_data[0][5]\n\n    if scores > 0.5:\n        x1, y1, x2, y2 = boxes\n        x1 = int(x1 * frame_width)\n        y1 = int(y1 * frame_height)\n        x2 = int(x2 * frame_width)\n        y2 = int(y2 * frame_height)\n        class_id = int(classes)\n        label = labels[class_id]\n        cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n        cv2.putText(frame, f\"{label}: {scores:.2f}\", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n    # Write the frame to the output video\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_e24603ca_1755054383.py\", line 13, in <module>\n    interpreter.allocate_tensor()\nAttributeError: 'Interpreter' object has no attribute 'allocate_tensor'"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 10
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 6144.816,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-24-06-133370_chatcmpl-3c71119d-fe13-458d-8a37-dc50bf63f37b",
          "traceId": "38b6e653",
          "type": "GENERATION",
          "name": "38b6_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:24:06.133000+00:00",
          "endTime": "2025-08-13T01:24:31.682000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 25549.0,
          "environment": "default",
          "completionTokens": 908,
          "totalTokens": 2874,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-24-39-754044_chatcmpl-93715eea-83a6-41d2-b1d7-059b555547c8",
          "traceId": "38b6e653",
          "type": "GENERATION",
          "name": "38b6_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:24:39.754000+00:00",
          "endTime": "2025-08-13T01:25:18.318000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 38564.0,
          "environment": "default",
          "completionTokens": 1413,
          "totalTokens": 3461,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-05-27-356034_chatcmpl-9e9ead64-dd63-448a-bec2-81265de6b3a3",
          "traceId": "38b6e653",
          "type": "GENERATION",
          "name": "38b6_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T03:05:27.356000+00:00",
          "endTime": "2025-08-13T03:05:52.588000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 25232.0,
          "environment": "default",
          "completionTokens": 895,
          "totalTokens": 2943,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-06-05-56-414406_chatcmpl-36363468-aebc-4f51-8e24-87277fbce3a9",
          "traceId": "38b6e653",
          "type": "GENERATION",
          "name": "38b6_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T03:05:56.414000+00:00",
          "endTime": "2025-08-13T03:06:23.347000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26933.0,
          "environment": "default",
          "completionTokens": 961,
          "totalTokens": 3009,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "75b26adb-6d4f-4bfa-b4c4-7ebc4421ddee",
          "traceId": "38b6e653",
          "type": "SPAN",
          "name": "error_38_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T03:06:30.949000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_e24603ca_1755054383.py\", line 13, in <module>\n    interpreter.allocate_tensor()\nAttributeError: 'Interpreter' object has no attribute 'allocate_tensor'",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T03:06:36.255Z",
      "createdAt": "2025-08-13T01:24:06.653Z"
    },
    {
      "id": "90680e9a",
      "timestamp": "2025-08-13T01:20:43.547000+00:00",
      "name": "9068_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nconfidence_threshold  = 0.5\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 30.0, (frame_width, frame_height))\n\nwhile(cap.isOpened()):\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Post-processing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0, ..., 1:5]\n   classes = output_data[0, ..., 5]\n   scores = output_data[0, ..., 6]\n\n   for i in range(boxes.shape[0]):\n       if scores[i] > confidence_threshold:\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame_width)\n           xmax = int(xmax * frame_width)\n           ymin = int(ymin * frame_height)\n           ymax = int(ymax * frame_height)\n\n           class_id = int(classes[i])\n           label = labels[class_id]\n\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           cv2.putText(frame, f'{label}: {scores[i]:.2f}', (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_432f6938_1755048233.py\", line 64, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 9
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 197.795,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-20-43-549424_chatcmpl-b256c2e8-063a-4ab9-a2da-6c9259b902f5",
          "traceId": "90680e9a",
          "type": "GENERATION",
          "name": "9068_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:20:43.549000+00:00",
          "endTime": "2025-08-13T01:21:09.535000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 25986.0,
          "environment": "default",
          "completionTokens": 924,
          "totalTokens": 2890,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-21-18-030272_chatcmpl-c20428dd-178b-497b-94f8-a121a94c15fc",
          "traceId": "90680e9a",
          "type": "GENERATION",
          "name": "9068_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:21:18.030000+00:00",
          "endTime": "2025-08-13T01:21:50.962000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32932.0,
          "environment": "default",
          "completionTokens": 1196,
          "totalTokens": 3244,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-21-59-273455_chatcmpl-285ad4e3-b384-4495-91c4-40ffcd32b510",
          "traceId": "90680e9a",
          "type": "GENERATION",
          "name": "9068_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T01:21:59.273000+00:00",
          "endTime": "2025-08-13T01:22:30.698000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31425.0,
          "environment": "default",
          "completionTokens": 1136,
          "totalTokens": 3184,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-22-39-019200_chatcmpl-12c0e15a-1a85-4dc7-b1f2-f5aeacc319f7",
          "traceId": "90680e9a",
          "type": "GENERATION",
          "name": "9068_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:22:39.019000+00:00",
          "endTime": "2025-08-13T01:23:09.727000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30708.0,
          "environment": "default",
          "completionTokens": 1108,
          "totalTokens": 3156,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-23-18-105286_chatcmpl-87a5e219-519f-4549-b5c4-1833108af88c",
          "traceId": "90680e9a",
          "type": "GENERATION",
          "name": "9068_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:23:18.105000+00:00",
          "endTime": "2025-08-13T01:23:53.019000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 34914.0,
          "environment": "default",
          "completionTokens": 1271,
          "totalTokens": 3319,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "8d9dd7ef-77fd-40df-abcb-28ab2e3811d7",
          "traceId": "90680e9a",
          "type": "SPAN",
          "name": "error_90_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:24:01.344000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_432f6938_1755048233.py\", line 64, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:24:06.817Z",
      "createdAt": "2025-08-13T01:20:44.068Z"
    },
    {
      "id": "fd403fc0",
      "timestamp": "2025-08-13T01:17:32.716000+00:00",
      "name": "fd40_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\nfrom tflite_runtime.interpreter import Interpreter\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter\ninterpreter = Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Video Setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video stream or file\")\n   exit()\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\n# Inference Loop\nwhile(cap.isOpened()):\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n   if input_data_type == np.float32:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n   else:\n       input_data = input_data.astype(np.uint8)  # Explicitly convert to uint8\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Post-processing\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n\n   boxes = output_data[0][0][:, :4]\n   classes = output_data[0][0][:, 4]\n   scores = output_data[0][0][:, 5]\n\n   confidence_threshold = 0.5\n   for i in range(len(scores)):\n       if scores[i] > confidence_threshold:\n           x0, y0, x1, y1 = boxes[i]\n           x0, y0, x1, y1 = int(x0 * frame.shape[1]), int(y0 * frame.shape[0]), int(x1 * frame.shape[1]), int(y1 * frame.shape[0])\n           class_id = int(classes[i])\n           label = labels[class_id]\n           confidence = scores[i]\n\n           cv2.rectangle(frame, (x0, y0), (x1, y1), (0, 255, 0), 2)\n           cv2.putText(frame, f\"{label}: {confidence:.2f}\", (x0, y0 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   # Write output\n   out.write(frame)\n\n   # Display (optional)\n   cv2.imshow('Object Detection', frame)\n   if cv2.waitKey(1) & 0xFF == ord('q'):\n       break\n\n# Cleanup\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_bdb1c432_1755048029.py\", line 3, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 8
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 184.709,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-17-32-717743_chatcmpl-8e508aec-df35-467c-9811-6aa21d5f5f54",
          "traceId": "fd403fc0",
          "type": "GENERATION",
          "name": "fd40_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:17:32.717000+00:00",
          "endTime": "2025-08-13T01:18:00.570000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27853.0,
          "environment": "default",
          "completionTokens": 995,
          "totalTokens": 2961,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-18-08-951283_chatcmpl-4a77a8e7-9df0-492d-beb4-cdbecf19d514",
          "traceId": "fd403fc0",
          "type": "GENERATION",
          "name": "fd40_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:18:08.951000+00:00",
          "endTime": "2025-08-13T01:18:41.434000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32483.0,
          "environment": "default",
          "completionTokens": 1177,
          "totalTokens": 3225,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-18-45-461776_chatcmpl-ca76750d-f129-424a-a697-a4bd711fc7ef",
          "traceId": "fd403fc0",
          "type": "GENERATION",
          "name": "fd40_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T01:18:45.461000+00:00",
          "endTime": "2025-08-13T01:19:14.617000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29156.0,
          "environment": "default",
          "completionTokens": 1046,
          "totalTokens": 3094,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-19-22-940599_chatcmpl-19578b99-5b95-489d-a83d-7a138af730d5",
          "traceId": "fd403fc0",
          "type": "GENERATION",
          "name": "fd40_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:19:22.940000+00:00",
          "endTime": "2025-08-13T01:19:51.805000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28865.0,
          "environment": "default",
          "completionTokens": 1035,
          "totalTokens": 3083,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-19-59-714470_chatcmpl-5d469935-a6de-4833-9b7a-72da43a54a6d",
          "traceId": "fd403fc0",
          "type": "GENERATION",
          "name": "fd40_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:19:59.714000+00:00",
          "endTime": "2025-08-13T01:20:29.536000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29822.0,
          "environment": "default",
          "completionTokens": 1073,
          "totalTokens": 3121,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "97c8c308-ef7e-41bf-ad75-80dabd4603f4",
          "traceId": "fd403fc0",
          "type": "SPAN",
          "name": "error_fd_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:20:37.426000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_bdb1c432_1755048029.py\", line 3, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:20:43.027Z",
      "createdAt": "2025-08-13T01:17:33.236Z"
    },
    {
      "id": "e8454610",
      "timestamp": "2025-08-13T01:14:24.663000+00:00",
      "name": "e845_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import tensorflow as tf\nimport cv2\nimport numpy as np\n\n# Load labels\nlabels = []\nwith open('/home/mendyg/projects/edge_detection/models/labelmap.txt', 'r') as f:\n   for line in f:\n       labels.append(line.strip())\n\n# Load interpreter with EdgeTPU\ntry:\n   interpreter = tf.lite.Interpreter(model_path='/home/mendyg/projects/edge_detection/models/detect.tflite', experimental_delegates=[tf.lite.experimental.load_delegate('libedgetpu.so.1')])\nexcept:\n   interpreter = tf.lite.Interpreter(model_path='/home/mendyg/projects/edge_detection/models/detect.tflite')\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_details  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Input resolution\ninput_height = input_details[0]['shape'][1]\ninput_width = input_details[0]['shape'][2]\n\n# Output details\nnum_boxes = output_details[0]['shape'][1]\n\n# Initialize video capture\ncap = cv2.VideoCapture('/home/mendyg/projects/edge_detection/data/sheeps.mp4')\nif not cap.isOpened():\n   print(\"Error opening video stream or file\")\n   exit()\n\n# Define codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter('/home/mendyg/projects/edge_detection/results/sheeps_detection.mp4', fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\n# Main loop\nwhile(cap.isOpened()):\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Resize frame to model input size\n   resized_frame = cv2.resize(frame, (input_width, input_height))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   # Normalize the input data\n   input_data = input_data.astype(np.float32)\n   input_data /= 255.0\n\n   # Run inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Get output\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0][0:num_boxes, 0:4]\n   classes = output_data[0][0:num_boxes, 4]\n   scores = output_data[0][0:num_boxes, 5]\n\n   # Apply confidence threshold\n   confidence_threshold = 0.5\n   for i in range(num_boxes):\n       if scores[i] > confidence_threshold:\n           # Extract bounding box coordinates\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame.shape[1])\n           xmax = int(xmax * frame.shape[1])\n           ymin = int(ymin * frame.shape[0])\n           ymax = int(ymax * frame.shape[0])\n\n           # Get class label\n           class_id = int(classes[i])\n           label = labels[class_id]\n\n           # Draw bounding box and label\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           cv2.putText(frame, f'{label}: {scores[i]:.2f}', (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   # Write the frame to the output video\n   out.write(frame)\n\n   # Display the resulting frame\n   cv2.imshow('Object Detection', frame)\n\n   # Press Q on keyboard to exit\n   if cv2.waitKey(25) & 0xFF == ord('q'):\n       break\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_639bbbf8_1755047841.py\", line 1, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 7
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 181.092,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-14-24-665301_chatcmpl-c5d335b4-4324-42ab-85b7-7d92488cc46c",
          "traceId": "e8454610",
          "type": "GENERATION",
          "name": "e845_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:14:24.665000+00:00",
          "endTime": "2025-08-13T01:14:53.447000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28782.0,
          "environment": "default",
          "completionTokens": 1030,
          "totalTokens": 2996,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-15-01-575082_chatcmpl-39ae473e-22d1-48cf-a2e9-b678a580b540",
          "traceId": "e8454610",
          "type": "GENERATION",
          "name": "e845_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:15:01.575000+00:00",
          "endTime": "2025-08-13T01:15:32.035000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30460.0,
          "environment": "default",
          "completionTokens": 1098,
          "totalTokens": 3146,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-15-36-009029_chatcmpl-456ca030-bce7-451f-b6ea-6bb6aabb1b7d",
          "traceId": "e8454610",
          "type": "GENERATION",
          "name": "e845_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T01:15:36.009000+00:00",
          "endTime": "2025-08-13T01:16:07.713000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31704.0,
          "environment": "default",
          "completionTokens": 1147,
          "totalTokens": 3195,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-16-11-717498_chatcmpl-7142830d-3b5c-4774-8006-4cd6c4aab27f",
          "traceId": "e8454610",
          "type": "GENERATION",
          "name": "e845_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:16:11.717000+00:00",
          "endTime": "2025-08-13T01:16:45.580000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 33863.0,
          "environment": "default",
          "completionTokens": 1230,
          "totalTokens": 3278,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-16-49-609144_chatcmpl-e3872a69-9e22-404f-ae8b-4a7e071dabbd",
          "traceId": "e8454610",
          "type": "GENERATION",
          "name": "e845_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:16:49.609000+00:00",
          "endTime": "2025-08-13T01:17:21.741000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32132.0,
          "environment": "default",
          "completionTokens": 1161,
          "totalTokens": 3209,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "dc01d858-d9e2-4e5c-91ae-e26487cca646",
          "traceId": "e8454610",
          "type": "SPAN",
          "name": "error_e8_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:17:25.757000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_639bbbf8_1755047841.py\", line 1, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:17:30.965Z",
      "createdAt": "2025-08-13T01:14:25.185Z"
    },
    {
      "id": "c956f84e",
      "timestamp": "2025-08-13T01:11:10.548000+00:00",
      "name": "c956_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\nconfidence_threshold  = 0.5\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Video setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Input Acquisition & Preprocessing Loop\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocess Data\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n\n   if floating_model:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Output Interpretation & Handling\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   confidence = output_data[0][5]\n\n   if confidence > confidence_threshold:\n       x1 = int(boxes[0] * frame_width)\n       y1 = int(boxes[1] * frame_height)\n       x2 = int(boxes[2] * frame_width)\n       y2 = int(boxes[3] * frame_height)\n\n       label = labels[int(classes)]\n\n       cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n       cv2.putText(frame, f'{label}: {confidence:.2f}', (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n   out.write(frame)\n\n# Cleanup\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_59198240_1755047648.py\", line 68, in <module>\n    if confidence > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 6
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 186.731,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-11-10-550656_chatcmpl-80587960-6d72-4679-81a3-f16a3a9df8a9",
          "traceId": "c956f84e",
          "type": "GENERATION",
          "name": "c956_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:11:10.550000+00:00",
          "endTime": "2025-08-13T01:11:35.700000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 25150.0,
          "environment": "default",
          "completionTokens": 893,
          "totalTokens": 2859,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-11-44-023895_chatcmpl-1db7b7c6-97c7-453a-84ea-bce758701d4c",
          "traceId": "c956f84e",
          "type": "GENERATION",
          "name": "c956_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:11:44.023000+00:00",
          "endTime": "2025-08-13T01:12:15.836000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31813.0,
          "environment": "default",
          "completionTokens": 1151,
          "totalTokens": 3199,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-12-24-329614_chatcmpl-d832fd08-19eb-4f4c-a72f-018354e14e7c",
          "traceId": "c956f84e",
          "type": "GENERATION",
          "name": "c956_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T01:12:24.329000+00:00",
          "endTime": "2025-08-13T01:12:53.322000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 28993.0,
          "environment": "default",
          "completionTokens": 1038,
          "totalTokens": 3086,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-13-01-637902_chatcmpl-112846c5-4522-494e-931a-a8504dc91efb",
          "traceId": "c956f84e",
          "type": "GENERATION",
          "name": "c956_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:13:01.637000+00:00",
          "endTime": "2025-08-13T01:13:33.334000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31697.0,
          "environment": "default",
          "completionTokens": 1144,
          "totalTokens": 3192,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-13-41-058527_chatcmpl-613863e8-6b68-4deb-a295-a1bde0dade2f",
          "traceId": "c956f84e",
          "type": "GENERATION",
          "name": "c956_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:13:41.058000+00:00",
          "endTime": "2025-08-13T01:14:08.884000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27826.0,
          "environment": "default",
          "completionTokens": 995,
          "totalTokens": 3043,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "a7de2516-f4ac-4723-8403-4d66f67afa40",
          "traceId": "c956f84e",
          "type": "SPAN",
          "name": "error_c9_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:14:17.281000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_59198240_1755047648.py\", line 68, in <module>\n    if confidence > confidence_threshold:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:14:22.829Z",
      "createdAt": "2025-08-13T01:11:11.070Z"
    },
    {
      "id": "d0b56e1d",
      "timestamp": "2025-08-13T01:07:53.949000+00:00",
      "name": "d0b5_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Get input and output details\ninput_shape = input_details[0]['shape']\noutput_shape = output_details[0]['shape']\n\n# Load video\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n    print(\"Error opening video file\")\n    exit()\n\n# Define video writer\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\n# Inference Loop\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocessing\n    resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(resized_frame, axis=0)\n\n    # Check the input type and convert if necessary\n    if input_details[0]['dtype'] == np.uint8:\n        input_data = input_data.astype(np.uint8)\n    elif input_details[0]['dtype'] == np.float32:\n        input_data = input_data.astype(np.float32)\n        input_data = input_data / 255.0  # Normalize if float32\n\n    # Run Inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Postprocessing\n    output_data = interpreter.get_tensor(output_details[0]['index'])\n    boxes = output_data[0][0:4]\n    classes = output_data[0][4]\n    confidence = output_data[0][5]\n\n    if confidence > 0.5:\n        xmin = int(boxes[0] * frame.shape[1])\n        ymin = int(boxes[1] * frame.shape[0])\n        xmax = int(boxes[2] * frame.shape[1])\n        ymax = int(boxes[3] * frame.shape[0])\n\n        label = labels[int(classes)]\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n        cv2.putText(frame, f'{label}: {confidence:.2f}', (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (0, 255, 0), 2)\n\n    # Write to output video\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_30477ec9_1755047456.py\", line 66, in <module>\n    if confidence > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 5
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 190.69,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-07-53-952244_chatcmpl-5a1e31d0-1b37-4459-81d2-2e62fa1ccd91",
          "traceId": "d0b56e1d",
          "type": "GENERATION",
          "name": "d0b5_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:07:53.952000+00:00",
          "endTime": "2025-08-13T01:08:17.408000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 23456.0,
          "environment": "default",
          "completionTokens": 829,
          "totalTokens": 2795,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-08-25-766232_chatcmpl-99d6cf16-c3cd-4e8a-b484-ebac22b8a439",
          "traceId": "d0b56e1d",
          "type": "GENERATION",
          "name": "d0b5_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:08:25.766000+00:00",
          "endTime": "2025-08-13T01:08:57.499000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31733.0,
          "environment": "default",
          "completionTokens": 1148,
          "totalTokens": 3196,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-09-05-783229_chatcmpl-47b6af24-b5ca-40a4-a80e-e2c0139355c8",
          "traceId": "d0b56e1d",
          "type": "GENERATION",
          "name": "d0b5_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T01:09:05.783000+00:00",
          "endTime": "2025-08-13T01:09:35.704000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29921.0,
          "environment": "default",
          "completionTokens": 1076,
          "totalTokens": 3124,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-09-43-994738_chatcmpl-1b1cc756-add3-46fb-b5e5-a4ff66bcfaef",
          "traceId": "d0b56e1d",
          "type": "GENERATION",
          "name": "d0b5_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:09:43.994000+00:00",
          "endTime": "2025-08-13T01:10:16.054000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32060.0,
          "environment": "default",
          "completionTokens": 1157,
          "totalTokens": 3205,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-10-24-590601_chatcmpl-d5910afa-c889-44e4-850d-2552f93810e9",
          "traceId": "d0b56e1d",
          "type": "GENERATION",
          "name": "d0b5_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:10:24.590000+00:00",
          "endTime": "2025-08-13T01:10:56.273000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31683.0,
          "environment": "default",
          "completionTokens": 1146,
          "totalTokens": 3194,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "d44a7b4c-0975-4cb6-a8e7-7ee3914e8c82",
          "traceId": "d0b56e1d",
          "type": "SPAN",
          "name": "error_d0_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:11:04.642000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_30477ec9_1755047456.py\", line 66, in <module>\n    if confidence > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:11:10.269Z",
      "createdAt": "2025-08-13T01:07:54.469Z"
    },
    {
      "id": "2b830517",
      "timestamp": "2025-08-13T01:04:54.505000+00:00",
      "name": "2b83_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport tensorflow as tf\nimport cv2\n\n# Model configuration\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\n# input_shape = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\" # This is a video path, not a shape\ninput_shape  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\ninput_dtype = np.float32  # Or np.uint8, depending on your model\nlabels = [\"sheep\", \"person\", \"car\"]  # Replace with your labels\n\n# Video and output paths\ninput_video_path = \"/home/mendel/tinyml_autopilot/data/sheeps.mp4\"  # Replace with your video path\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load the TFLite model\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Check input details\nprint(\"Input details:\", input_details)\nprint(\"Output details:\", output_details)\n\n# Video Capture\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n    print(\"Error opening video stream or file\")\n    exit()\n\n# Video Writer\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Inference Loop\nwhile (cap.isOpened()):\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocessing\n    resized_frame = cv2.resize(frame, (input_shape[0], input_shape[1]))\n    input_data = np.expand_dims(resized_frame, axis=0)\n    if input_dtype == np.float32:\n        input_data = (np.float32(input_data) - 127.5) / 127.5\n    else:\n        input_data = np.uint8(input_data)\n\n    # Inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Post-processing\n    output_data = interpreter.get_tensor(output_details[0]['index'])\n    boxes = output_data[0, ..., 0:4]\n    classes = output_data[0, ..., 4]\n    scores = output_data[0, ..., 5]\n\n    # Apply confidence threshold\n    confidence_threshold = 0.5\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            box = boxes[i]\n            class_id = int(classes[i])\n            label = labels[class_id]\n            confidence = scores[i]\n\n            # Scale the bounding box coordinates\n            x_min = int(box[0] * frame_width)\n            y_min = int(box[1] * frame_height)\n            x_max = int(box[2] * frame_width)\n            y_max = int(box[3] * frame_height)\n\n            # Draw bounding box and label\n            cv2.rectangle(frame, (x_min, y_min), (x_max, y_max), (0, 255, 0), 2)\n            label_text = f\"{label}: {confidence:.2f}\"\n            cv2.putText(frame, label_text, (x_min, y_min - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write the output frame\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_4753cb97_1755047262.py\", line 2, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 4
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 172.612,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-04-54-506928_chatcmpl-258d48c6-340a-4444-9e8d-1616f5f6bbf2",
          "traceId": "2b830517",
          "type": "GENERATION",
          "name": "2b83_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:04:54.506000+00:00",
          "endTime": "2025-08-13T01:05:22.352000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27846.0,
          "environment": "default",
          "completionTokens": 996,
          "totalTokens": 2962,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-05-30-704338_chatcmpl-52dee1f1-4c89-4254-8995-2ecd7422beb7",
          "traceId": "2b830517",
          "type": "GENERATION",
          "name": "2b83_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:05:30.704000+00:00",
          "endTime": "2025-08-13T01:05:55.151000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 24447.0,
          "environment": "default",
          "completionTokens": 868,
          "totalTokens": 2916,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-05-59-213871_chatcmpl-d6430cb2-e54c-4b85-b0b2-02a43ac9d6b7",
          "traceId": "2b830517",
          "type": "GENERATION",
          "name": "2b83_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T01:05:59.213000+00:00",
          "endTime": "2025-08-13T01:06:29.619000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30406.0,
          "environment": "default",
          "completionTokens": 1096,
          "totalTokens": 3144,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-06-34-164571_chatcmpl-cdc7b0b5-a0f0-4240-8b9f-7ed14a35ef53",
          "traceId": "2b830517",
          "type": "GENERATION",
          "name": "2b83_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:06:34.164000+00:00",
          "endTime": "2025-08-13T01:07:05.698000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31534.0,
          "environment": "default",
          "completionTokens": 1140,
          "totalTokens": 3188,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-07-10-499470_chatcmpl-779877a0-626f-4559-919a-387cedb4ac21",
          "traceId": "2b830517",
          "type": "GENERATION",
          "name": "2b83_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:07:10.499000+00:00",
          "endTime": "2025-08-13T01:07:42.646000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32147.0,
          "environment": "default",
          "completionTokens": 1164,
          "totalTokens": 3212,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "7c20ab0c-b8ca-4dd3-8c5a-a0b6e37a5868",
          "traceId": "2b830517",
          "type": "SPAN",
          "name": "error_2b_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:07:47.118000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_4753cb97_1755047262.py\", line 2, in <module>\n    import tensorflow as tf\nModuleNotFoundError: No module named 'tensorflow'",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:07:52.294Z",
      "createdAt": "2025-08-13T01:04:55.026Z"
    },
    {
      "id": "94553bd3",
      "timestamp": "2025-08-13T01:01:45.022000+00:00",
      "name": "9455_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "from tf lite_runtime.interpreter import Interpreter, load_delegate\nimport cv2\nimport numpy as np\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Video setup\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n   print(\"Error opening video file\")\n   exit()\n\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Main loop\nwhile True:\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   # Preprocessing\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   input_data = np.expand_dims(resized_frame, axis=0)\n   if input_data_type == np.float32:\n       input_data = (np.float32(input_data) - 127.5) / 127.5\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n\n   # Postprocessing\n   boxes = output_data[0, ..., 1:5]\n   classes = output_data[0, ..., 5]\n   scores = output_data[0, ..., 6]\n\n   confidence_threshold = 0.5\n   for i in range(len(scores)):\n       if scores[i] > confidence_threshold:\n           ymin, xmin, ymax, xmax = boxes[i]\n           xmin = int(xmin * frame_width)\n           xmax = int(xmax * frame_width)\n           ymin = int(ymin * frame_height)\n           ymax = int(ymax * frame_height)\n\n           class_id = int(classes[i])\n           label = labels[class_id]\n           confidence = scores[i]\n\n           cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n           label_text = f\"{label}: {confidence:.2f}\"\n           cv2.putText(frame, label_text, (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   # Write output frame\n   out.write(frame)\n\n   # Display frame (optional)\n   cv2.imshow('Object Detection', frame)\n   if cv2.waitKey(1) & 0xFF == ord('q'):\n       break\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "  File \"script_18892ecd_1755047083.py\", line 1\n    from tf lite_runtime.interpreter import Interpreter, load_delegate\n                       ^\nSyntaxError: invalid syntax"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 3
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 182.834,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-01-45-024837_chatcmpl-6de8f45f-fdc5-4f84-a32d-5ec60f1dadbf",
          "traceId": "94553bd3",
          "type": "GENERATION",
          "name": "9455_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T01:01:45.024000+00:00",
          "endTime": "2025-08-13T01:02:12.709000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 27685.0,
          "environment": "default",
          "completionTokens": 988,
          "totalTokens": 2954,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-02-21-169324_chatcmpl-ff67174f-0b87-44e2-9345-a2aae5a72ea0",
          "traceId": "94553bd3",
          "type": "GENERATION",
          "name": "9455_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T01:02:21.169000+00:00",
          "endTime": "2025-08-13T01:02:54.810000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 33641.0,
          "environment": "default",
          "completionTokens": 1223,
          "totalTokens": 3271,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-02-58-801975_chatcmpl-2522516c-0509-4f18-95e0-d63e1ab3a647",
          "traceId": "94553bd3",
          "type": "GENERATION",
          "name": "9455_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T01:02:58.801000+00:00",
          "endTime": "2025-08-13T01:03:28.167000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29366.0,
          "environment": "default",
          "completionTokens": 1054,
          "totalTokens": 3102,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-03-32-175946_chatcmpl-f86b8d91-a2f4-44cd-8c4e-38f5c9a953e0",
          "traceId": "94553bd3",
          "type": "GENERATION",
          "name": "9455_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:03:32.175000+00:00",
          "endTime": "2025-08-13T01:04:05.947000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 33772.0,
          "environment": "default",
          "completionTokens": 1225,
          "totalTokens": 3273,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-04-13-816935_chatcmpl-77adafd8-41a1-492e-acb1-7f6a5814e674",
          "traceId": "94553bd3",
          "type": "GENERATION",
          "name": "9455_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:04:13.816000+00:00",
          "endTime": "2025-08-13T01:04:43.711000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29895.0,
          "environment": "default",
          "completionTokens": 1075,
          "totalTokens": 3123,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "965061af-7200-4f26-97ed-3464248bf915",
          "traceId": "94553bd3",
          "type": "SPAN",
          "name": "error_94_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:04:47.858000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error:   File \"script_18892ecd_1755047083.py\", line 1\n    from tf lite_runtime.interpreter import Interpreter, load_delegate\n                       ^\nSyntaxError: invalid syntax",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:04:53.296Z",
      "createdAt": "2025-08-13T01:01:45.545Z"
    },
    {
      "id": "493141d8",
      "timestamp": "2025-08-13T00:58:25.442000+00:00",
      "name": "4931_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n  labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n  interpreter = Interpreter(model_path=model_path,\n                            experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n  interpreter = Interpreter(model_path=model_path,\n                            experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\n# Initialize Video Capture\ncap = cv2.VideoCapture(input_video_path)\nif not cap.isOpened():\n  print(\"Error opening video file\")\n  exit()\n\n# Get video properties\nframe_width = int(cap.get(3))\nframe_height = int(cap.get(4))\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (frame_width, frame_height))\n\n# Main Loop\nwhile(cap.isOpened()):\n  ret, frame = cap.read()\n  if not ret:\n    break\n\n  # Preprocessing\n  resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n  input_data = np.expand_dims(resized_frame, axis=0)\n  if floating_model:\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n  # Inference\n  interpreter.set_tensor(input_details[0]['index'], input_data)\n  interpreter.invoke()\n\n  # Post-processing\n  output_data = interpreter.get_tensor(output_details[0]['index'])\n\n  boxes = output_data[0, ..., 1:5]\n  classes = output_data[0, ..., 5]\n  scores = output_data[0, ..., 6]\n\n  threshold = 0.5\n\n  for i in range(len(scores)):\n    if scores[i] > threshold:\n      ymin, xmin, ymax, xmax = boxes[i]\n      xmin = int(xmin * frame_width)\n      xmax = int(xmax * frame_width)\n      ymin = int(ymin * frame_height)\n      ymax = int(ymax * frame_height)\n\n      class_id = int(classes[i])\n      label = labels[class_id]\n\n      cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n      cv2.putText(frame, f'{label}: {scores[i]:.2f}', (xmin, ymin - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n  # Write the frame\n  out.write(frame)\n\n# Release everything when done\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_7bade229_1755046891.py\", line 64, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 2
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 194.395,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-03-58-25-444532_chatcmpl-7b7c8a24-59a1-407e-be27-699b07bd88bf",
          "traceId": "493141d8",
          "type": "GENERATION",
          "name": "4931_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T00:58:25.444000+00:00",
          "endTime": "2025-08-13T00:58:52.192000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26748.0,
          "environment": "default",
          "completionTokens": 951,
          "totalTokens": 2917,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-59-00-506103_chatcmpl-b3258160-a3de-485f-8862-6734c849b667",
          "traceId": "493141d8",
          "type": "GENERATION",
          "name": "4931_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T00:59:00.506000+00:00",
          "endTime": "2025-08-13T00:59:31.919000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31413.0,
          "environment": "default",
          "completionTokens": 1135,
          "totalTokens": 3183,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-59-40-362851_chatcmpl-879eac0f-8d3b-418d-aacf-f9f646bd4251",
          "traceId": "493141d8",
          "type": "GENERATION",
          "name": "4931_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T00:59:40.362000+00:00",
          "endTime": "2025-08-13T01:00:13.210000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32848.0,
          "environment": "default",
          "completionTokens": 1190,
          "totalTokens": 3238,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-00-21-917324_chatcmpl-1d89d345-a6df-4719-9857-65ce7555765d",
          "traceId": "493141d8",
          "type": "GENERATION",
          "name": "4931_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T01:00:21.917000+00:00",
          "endTime": "2025-08-13T01:00:51.955000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 30038.0,
          "environment": "default",
          "completionTokens": 1080,
          "totalTokens": 3128,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-01-00-141462_chatcmpl-a77815d0-2003-4a1d-9572-0f766602a59e",
          "traceId": "493141d8",
          "type": "GENERATION",
          "name": "4931_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T01:01:00.141000+00:00",
          "endTime": "2025-08-13T01:01:31.552000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 31411.0,
          "environment": "default",
          "completionTokens": 1134,
          "totalTokens": 3182,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "01b31c5b-7c26-4bef-ae76-a40c3683c808",
          "traceId": "493141d8",
          "type": "SPAN",
          "name": "error_49_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T01:01:39.839000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_7bade229_1755046891.py\", line 64, in <module>\n    classes = output_data[0, ..., 5]\nIndexError: index 5 is out of bounds for axis 2 with size 4",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T01:01:45.259Z",
      "createdAt": "2025-08-13T00:58:25.965Z"
    },
    {
      "id": "0cb09b9c",
      "timestamp": "2025-08-13T00:54:32.634000+00:00",
      "name": "0cb0_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import numpy as np\nimport cv2\nfrom tflite_runtime.interpreter import Interpreter, load_delegate\n\n# Configuration Parameters\nmodel_path  = \"/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite\"\nlabel_path  = \"/home/mendel/tinyml_autopilot/models/labelmap.txt\"\ninput_video_path  = \"/home/mendel/tinyml_autopilot/data//sheeps.mp4\"\noutput_video_path  = \"/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4\"\n\n# Load Labels\nwith open(label_path, 'r') as f:\n   labels = [line.strip() for line in f.readlines()]\n\n# Load Interpreter with EdgeTPU\ntry:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\nexcept:\n   interpreter = Interpreter(model_path=model_path,\n                             experimental_delegates=[load_delegate('/usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0')])\n\ninterpreter.allocate_tensors()\n\n# Get Model Details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\ninput_data_type = input_details[0]['dtype']\n\n# Input Acquisition & Preprocessing Loop\ncap = cv2.VideoCapture(input_video_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_video_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile(cap.isOpened()):\n   ret, frame = cap.read()\n   if not ret:\n       break\n\n   resized_frame = cv2.resize(frame, (input_shape[1], input_shape[2]))\n   # Normalize the image data and convert to the expected data type\n   if input_data_type == np.uint8:\n       input_data = resized_frame.astype(np.uint8)\n   elif input_data_type == np.float32:\n       input_data = resized_frame.astype(np.float32) / 255.0\n   else:\n       input_data = resized_frame.astype(np.float32) / 255.0\n\n   input_data = np.expand_dims(input_data, axis=0)\n\n   # Inference\n   interpreter.set_tensor(input_details[0]['index'], input_data)\n   interpreter.invoke()\n\n   # Output Interpretation & Handling\n   output_data = interpreter.get_tensor(output_details[0]['index'])\n   boxes = output_data[0][0:4]\n   classes = output_data[0][4]\n   confidence = output_data[0][5]\n\n   if confidence > 0.5:\n       class_id = int(classes)\n       label = labels[class_id]\n       x1, y1, x2, y2 = boxes\n       x1, y1, x2, y2 = int(x1 * frame.shape[1]), int(y1 * frame.shape[0]), int(x2 * frame.shape[1]), int(y2 * frame.shape[0])\n\n       cv2.rectangle(frame, (x1, y1), (x2, y2), (0, 255, 0), 2)\n       cv2.putText(frame, f\"{label}: {confidence:.2f}\", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n   out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Traceback (most recent call last):\n  File \"script_ea9a372d_1755046689.py\", line 63, in <module>\n    if confidence > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "session_id": "gemma3:27b_04fd_tpusg_batch",
      "metadata": {
        "num_run": 1
      },
      "tags": [
        "benchmark",
        "gemma3:27b",
        "tpu_sketch_generator"
      ],
      "latency": 224.863,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-03-54-32-636625_chatcmpl-957f447b-3895-4a3b-9a90-3c6d5ec5257f",
          "traceId": "0cb09b9c",
          "type": "GENERATION",
          "name": "0cb0_tpusg_gen_attempt#1",
          "startTime": "2025-08-13T00:54:32.636000+00:00",
          "endTime": "2025-08-13T00:55:28.397000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 55761.0,
          "environment": "default",
          "completionTokens": 812,
          "totalTokens": 2778,
          "promptTokens": 1966,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-55-36-648508_chatcmpl-81b11ffb-4d06-419f-a3e1-9cd32a7e61d5",
          "traceId": "0cb09b9c",
          "type": "GENERATION",
          "name": "0cb0_tpusg_gen_attempt#2",
          "startTime": "2025-08-13T00:55:36.648000+00:00",
          "endTime": "2025-08-13T00:56:09.456000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32808.0,
          "environment": "default",
          "completionTokens": 1115,
          "totalTokens": 3163,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-56-17-588533_chatcmpl-ae1b9853-cd18-47f8-bf86-ac171583948d",
          "traceId": "0cb09b9c",
          "type": "GENERATION",
          "name": "0cb0_tpusg_gen_attempt#3",
          "startTime": "2025-08-13T00:56:17.588000+00:00",
          "endTime": "2025-08-13T00:56:50.511000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32923.0,
          "environment": "default",
          "completionTokens": 1154,
          "totalTokens": 3202,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-56-58-524927_chatcmpl-08a82626-aa7e-4b65-90a3-5aacc3a71cbf",
          "traceId": "0cb09b9c",
          "type": "GENERATION",
          "name": "0cb0_tpusg_gen_attempt#4",
          "startTime": "2025-08-13T00:56:58.524000+00:00",
          "endTime": "2025-08-13T00:57:31.421000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 32897.0,
          "environment": "default",
          "completionTokens": 1191,
          "totalTokens": 3239,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-57-39-800261_chatcmpl-50528aaa-7572-4d99-8aac-bc5d466644f4",
          "traceId": "0cb09b9c",
          "type": "GENERATION",
          "name": "0cb0_tpusg_gen_attempt#5",
          "startTime": "2025-08-13T00:57:39.800000+00:00",
          "endTime": "2025-08-13T00:58:09.034000+00:00",
          "model": "gemma3:27b",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 29234.0,
          "environment": "default",
          "completionTokens": 1050,
          "totalTokens": 3098,
          "promptTokens": 2048,
          "costDetails": {},
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "b32d58e2-ca7a-4e16-8a87-f2056d17420a",
          "traceId": "0cb09b9c",
          "type": "SPAN",
          "name": "error_0c_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2025-08-13T00:58:17.499000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Traceback (most recent call last):\n  File \"script_ea9a372d_1755046689.py\", line 63, in <module>\n    if confidence > 0.5:\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()",
          "calculatedTotalCost": 0.0,
          "environment": "default",
          "completionTokens": 0,
          "totalTokens": 0,
          "promptTokens": 0,
          "costDetails": {},
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "updatedAt": "2025-08-13T00:58:22.980Z",
      "createdAt": "2025-08-13T00:54:33.156Z"
    }
  ],
  "meta": {
    "total_items": 30
  }
}